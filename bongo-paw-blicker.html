<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><meta name="msvalidate.01" content="BE3DB9F22A0915AF3452024048D66934"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif:300,300italic,400,400italic,700,700italic%7CFira+Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.css" integrity="sha256-vQkngPS8jiHHH0I6ABTZroZk8NPZ7b+MUReOFE9UsXQ=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-flash.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"siriusq.top","root":"/en/","images":"/en/images","scheme":"Gemini","darkmode":"auto","version":"8.18.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"width":320},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"manual"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":false,"lazyload":true,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><meta name="description" content="This article is a development record of Bongo Paw Clicker, documenting the issues I encountered during the development of the auto clicker."><meta property="og:type" content="article"><meta property="og:title" content="Bongo Paw Clicker Development Summary"><meta property="og:url" content="https://siriusq.top/en/bongo-paw-blicker.html"><meta property="og:site_name" content="Sirius"><meta property="og:description" content="This article is a development record of Bongo Paw Clicker, documenting the issues I encountered during the development of the auto clicker."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://s2.loli.net/2023/08/21/Yv84gpx6mU2TFfK.webp"><meta property="og:image" content="https://s2.loli.net/2023/08/18/G7k3ueC45sLVzPF.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/GuCkMH4gx7ldKPZ.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/ilZkBTWVf9gUxLO.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/ISOCrNd46uhEwtx.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/HGk9cCoqEwtledn.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/F364xwoDMdYuNEA.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/HVnKk74vDx6oQZW.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/G1knqmbt7juEM2x.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/iVex1vswbLakocI.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/qV8WgfKp1siz3he.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/Ym1iJnjEg9TUR8x.png"><meta property="og:image" content="https://s2.loli.net/2023/08/18/xZBtpjzkPunINsb.png"><meta property="article:published_time" content="2023-08-14T08:02:21.000Z"><meta property="article:modified_time" content="2023-08-21T13:47:57.034Z"><meta property="article:author" content="Sirius"><meta property="article:tag" content="WPF"><meta property="article:tag" content="Bongo Paw Clicker"><meta property="article:tag" content="Log"><meta property="article:tag" content="C#"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2023/08/21/Yv84gpx6mU2TFfK.webp"><link rel="canonical" href="https://siriusq.top/en/bongo-paw-blicker.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://siriusq.top/en/bongo-paw-blicker.html","path":"bongo-paw-blicker.html","title":"Bongo Paw Clicker Development Summary"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Bongo Paw Clicker Development Summary | Sirius</title><script src="/en/live2d-widget/autoload.js"></script><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Sirius" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Sirius</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">May the Force be with you</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/en/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/en/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">92</span></a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">8</span></a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">54</span></a></li><li class="menu-item menu-item-tools"><a href="/en/tools/" rel="section"><i class="fa fa-screwdriver-wrench fa-fw"></i>Tools</a></li><li class="menu-item menu-item-switch-to-chinese"><a href="https://siriusq.top/" rel="section"><i class="fa fa-language fa-fw"></i>Switch to Chinese</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Links"><span class="nav-number">1.</span> <span class="nav-text">Links</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UI-Design"><span class="nav-number">2.</span> <span class="nav-text">UI Design</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Window-Layout"><span class="nav-number">2.1.</span> <span class="nav-text">Window Layout</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Grid"><span class="nav-number">2.1.1.</span> <span class="nav-text">Grid</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#StackPanel"><span class="nav-number">2.1.2.</span> <span class="nav-text">StackPanel</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Material-Design"><span class="nav-number">2.2.</span> <span class="nav-text">Material Design</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Usage"><span class="nav-number">2.2.1.</span> <span class="nav-text">Usage</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Window-Style"><span class="nav-number">2.3.</span> <span class="nav-text">Window Style</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Function-Buttons"><span class="nav-number">2.3.1.</span> <span class="nav-text">Function Buttons</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Window-Shadow"><span class="nav-number">2.3.2.</span> <span class="nav-text">Window Shadow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Window-Rounded-Corners"><span class="nav-number">2.3.3.</span> <span class="nav-text">Window Rounded Corners</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Window-Animation"><span class="nav-number">2.3.4.</span> <span class="nav-text">Window Animation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Create-Animations"><span class="nav-number">2.3.4.1.</span> <span class="nav-text">Create Animations</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Opacity"><span class="nav-number">2.3.4.1.1.</span> <span class="nav-text">Opacity</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Window-Stretch"><span class="nav-number">2.3.4.1.2.</span> <span class="nav-text">Window Stretch</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Trigger-Animations"><span class="nav-number">2.3.4.2.</span> <span class="nav-text">Trigger Animations</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Images-and-Audio"><span class="nav-number">3.</span> <span class="nav-text">Images and Audio</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Application-Icon"><span class="nav-number">3.1.</span> <span class="nav-text">Application Icon</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bongo-Cat"><span class="nav-number">3.2.</span> <span class="nav-text">Bongo Cat</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Play-Audio"><span class="nav-number">3.3.</span> <span class="nav-text">Play Audio</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UI-Thread"><span class="nav-number">3.4.</span> <span class="nav-text">UI Thread</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dispatcher"><span class="nav-number">3.5.</span> <span class="nav-text">Dispatcher</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Settings-Panel"><span class="nav-number">4.</span> <span class="nav-text">Settings Panel</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Create-the-Window"><span class="nav-number">4.1.</span> <span class="nav-text">Create the Window</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ShowDialog-and-Show"><span class="nav-number">4.2.</span> <span class="nav-text">ShowDialog and Show</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Show"><span class="nav-number">4.2.1.</span> <span class="nav-text">Show</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ShowDialog"><span class="nav-number">4.2.2.</span> <span class="nav-text">ShowDialog</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Theme-Switch"><span class="nav-number">5.</span> <span class="nav-text">Theme Switch</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Simulate-Mouse-Clicks"><span class="nav-number">6.</span> <span class="nav-text">Simulate Mouse Clicks</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SetCursorPos"><span class="nav-number">6.1.</span> <span class="nav-text">SetCursorPos</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mouse-event"><span class="nav-number">6.2.</span> <span class="nav-text">mouse_event</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Capturing-Mouse-Coordinates"><span class="nav-number">7.</span> <span class="nav-text">Capturing Mouse Coordinates</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Create-New-Window"><span class="nav-number">7.1.</span> <span class="nav-text">Create New Window</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Get-Cursor-Coordinates"><span class="nav-number">7.2.</span> <span class="nav-text">Get Cursor Coordinates</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rectangle-Preview-and-Capture"><span class="nav-number">7.3.</span> <span class="nav-text">Rectangle Preview and Capture</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Store-User-Configuration"><span class="nav-number">8.</span> <span class="nav-text">Store User Configuration</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hotkey-Configuration"><span class="nav-number">9.</span> <span class="nav-text">Hotkey Configuration</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Configuring-Hotkeys"><span class="nav-number">9.1.</span> <span class="nav-text">Configuring Hotkeys</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UI"><span class="nav-number">9.1.1.</span> <span class="nav-text">UI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Preprocess-Keyboard-Events"><span class="nav-number">9.1.2.</span> <span class="nav-text">Preprocess Keyboard Events</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Register-x2F-Unregister-Global-Hotkeys"><span class="nav-number">9.2.</span> <span class="nav-text">Register&#x2F;Unregister Global Hotkeys</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#RegisterHotKey-Function"><span class="nav-number">9.2.1.</span> <span class="nav-text">RegisterHotKey Function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UnregisterHotKey-Function"><span class="nav-number">9.2.2.</span> <span class="nav-text">UnregisterHotKey Function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Binding-Hotkey-Functionality"><span class="nav-number">9.2.3.</span> <span class="nav-text">Binding Hotkey Functionality</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Handle-Hotkey-Messages"><span class="nav-number">9.2.4.</span> <span class="nav-text">Handle Hotkey Messages</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Change-Hotkeys"><span class="nav-number">9.3.</span> <span class="nav-text">Change Hotkeys</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Read-in-and-Save-Hotkeys"><span class="nav-number">9.4.</span> <span class="nav-text">Read-in and Save Hotkeys</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Localization"><span class="nav-number">10.</span> <span class="nav-text">Localization</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Create-Resource-Files"><span class="nav-number">10.1.</span> <span class="nav-text">Create Resource Files</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Usage-1"><span class="nav-number">10.2.</span> <span class="nav-text">Usage</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#XAML"><span class="nav-number">10.2.1.</span> <span class="nav-text">XAML</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Code"><span class="nav-number">10.2.2.</span> <span class="nav-text">Code</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Runtime"><span class="nav-number">10.3.</span> <span class="nav-text">Runtime</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Packaging-the-Program"><span class="nav-number">11.</span> <span class="nav-text">Packaging the Program</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Costura-Fody"><span class="nav-number">11.1.</span> <span class="nav-text">Costura.Fody</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Installation-and-Usage"><span class="nav-number">11.1.1.</span> <span class="nav-text">Installation and Usage</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#New-Issue"><span class="nav-number">11.1.2.</span> <span class="nav-text">New Issue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Satellite-Assemblies"><span class="nav-number">11.1.3.</span> <span class="nav-text">Satellite Assemblies</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Primary-Assembly"><span class="nav-number">11.1.3.1.</span> <span class="nav-text">Primary Assembly</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Satellite-Assembly"><span class="nav-number">11.1.3.2.</span> <span class="nav-text">Satellite Assembly</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Summary"><span class="nav-number">11.1.3.3.</span> <span class="nav-text">Summary</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Important-Note"><span class="nav-number">11.1.4.</span> <span class="nav-text">Important Note</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Resource-Embedder"><span class="nav-number">11.2.</span> <span class="nav-text">Resource.Embedder</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#NET-Framework"><span class="nav-number">12.</span> <span class="nav-text">.NET Framework</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Relationship-Between-NET-Framework-Versions-and-Windows-Versions"><span class="nav-number">12.1.</span> <span class="nav-text">Relationship Between .NET Framework Versions and Windows Versions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NET-Core-vs-NET-Framework"><span class="nav-number">12.2.</span> <span class="nav-text">.NET Core vs. .NET Framework</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Sirius" src="https://s2.loli.net/2022/05/23/kxtRKT4u71HXlUY.gif"><p class="site-author-name" itemprop="name">Sirius</p><div class="site-description" itemprop="description">Thread_sleep(1); //be nice to the CPU</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/en/archives/"><span class="site-state-item-count">54</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/en/categories/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/en/tags/"><span class="site-state-item-count">92</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Siriusq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Siriusq" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="/en/atom.xml" title="RSS Feed → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i>RSS Feed</a> </span><span class="links-of-author-item"><a href="mailto:siriusq.top@outlook.com" title="E-Mail → mailto:siriusq.top@outlook.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://leetcode.com/Siriusq/" title="LeetCode → https:&#x2F;&#x2F;leetcode.com&#x2F;Siriusq&#x2F;" rel="noopener me" target="_blank"><i class="fa fa-code fa-fw"></i>LeetCode</a></span></div><script src="/en/js/switch_limited.js"></script></div></div><div class="back-to-top animated" role="button" aria-label="Back to top"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://siriusq.top/en/bongo-paw-blicker.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://s2.loli.net/2022/05/23/kxtRKT4u71HXlUY.gif"><meta itemprop="name" content="Sirius"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sirius"><meta itemprop="description" content="Thread_sleep(1); //be nice to the CPU"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Bongo Paw Clicker Development Summary | Sirius"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Bongo Paw Clicker Development Summary</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2023-08-14 16:02:21" itemprop="dateCreated datePublished" datetime="2023-08-14T16:02:21+08:00">2023-08-14</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2023-08-21 21:47:57" itemprop="dateModified" datetime="2023-08-21T21:47:57+08:00">2023-08-21</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a> </span></span><span class="post-meta-item" title="Views" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">Views: </span><span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="Word count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">Word count in article: </span><span>8.9k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span>33 mins.</span></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote class="blockquote-center">This article is a development record of Bongo Paw Clicker, documenting the issues I encountered during the development of the auto clicker.</blockquote><p><img data-src="https://s2.loli.net/2023/08/21/Yv84gpx6mU2TFfK.webp" alt="en-preview.webp"></p><span id="more"></span><h1 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h1><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/bongoClicker.webp"></object><p>Bongo Paw Clicker</p><p>An auto clicker with bongo cat integrated</p><a target="_blank" rel="noopener" href="https://github.com/Siriusq/BongoPawClicker/releases/download/v1.0/BongoPawClicker.exe"></a></div><div class="link-grid-container"><object class="link-grid-image" data="/images/link/github.webp"></object><p>Github Repo Link</p><p>GitHub repository of Bongo Paw Clicker</p><a target="_blank" rel="noopener" href="https://github.com/Siriusq/BongoPawClicker"></a></div></div><h1 id="UI-Design"><a href="#UI-Design" class="headerlink" title="UI Design"></a>UI Design</h1><p>WPF employs the Extensible Application Markup Language (<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/visualstudio/xaml-tools/xaml-overview?view=vs-2022">XAML</a>) to generate UI elements. The <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/visualstudio/xaml-tools/creating-a-ui-by-using-xaml-designer-in-visual-studio?view=vs-2022">XAML Designer</a> in Visual Studio offers a visual interface to assist in UI design. Using XAML is somewhat akin to working with CSS, and it’s relatively easy to get started. The real challenge lies in the design aspect. On a personal note: I find that as a programmer, handling UI design can be truly exhausting – I often spend more time designing the UI than actually writing the code.</p><h2 id="Window-Layout"><a href="#Window-Layout" class="headerlink" title="Window Layout"></a>Window Layout</h2><p>In my UI design, I utilized the Grid and StackPanel elements for layout purposes. The Grid is used to create horizontal functional areas, while the StackPanel is employed to arrange components horizontally within each row of the Grid. For more layout options, you can refer to the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/visualstudio/xaml-tools/organize-objects-into-layout-containers-in-xaml-designer?view=vs-2022">Microsoft documentation</a>.</p><p>When placing multiple components directly within the same Grid, these components stack on top of each other instead of arranging in order. To achieve uniform spacing, one needs to assign Margins to each component individually, which can be quite cumbersome. That’s why I decided to nest a StackPanel within the Grid for component arrangement.</p><h3 id="Grid"><a href="#Grid" class="headerlink" title="Grid"></a>Grid</h3><p>As the name implies, the Grid divides the panel into different grids.</p><details class="note success"><summary><p>Grid Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Grid</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span> <span class="comment">&lt;!-- Define rows --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">&quot;50&quot;</span> /&gt;</span> <span class="comment">&lt;!-- Define parameters for the first row, setting its height to 50 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">&quot;60&quot;</span> /&gt;</span> <span class="comment">&lt;!-- Define parameters for the second row --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">Grid.Row</span>=<span class="string">&quot;0&quot;</span>&gt;</span> <span class="comment">&lt;!-- First row --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Grid.ColumnDefinitions</span>&gt;</span> <span class="comment">&lt;!-- Define columns --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">&quot;130&quot;</span> /&gt;</span> <span class="comment">&lt;!-- Define parameters for the first column, setting its width to 130 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">&quot;*&quot;</span> /&gt;</span> <span class="comment">&lt;!-- Define parameters for the second column, using * to take up the remaining width in the row. If multiple columns have a width set to *, they will share the remaining width equally --&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">Grid.Column</span>=<span class="string">&quot;0&quot;</span>&gt;</span> <span class="comment">&lt;!-- Content of the first column --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Some Content --&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">Grid.Column</span>=<span class="string">&quot;1&quot;</span>&gt;</span> <span class="comment">&lt;!-- Content of the second column --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Some Content --&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">Grid.Row</span>=<span class="string">&quot;1&quot;</span>&gt;</span> <span class="comment">&lt;!-- Second row --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">&quot;2*&quot;</span> /&gt;</span> <span class="comment">&lt;!-- Here, 2* means it occupies 2/7 of the available width --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">&quot;5*&quot;</span> /&gt;</span> <span class="comment">&lt;!-- Here, 5* means it occupies 5/7 of the available width --&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br></pre></td></tr></table></figure></details><h3 id="StackPanel"><a href="#StackPanel" class="headerlink" title="StackPanel"></a>StackPanel</h3><p>StackPanel can arrange components horizontally or vertically in a single row. It does not automatically wrap content to the next line; any content exceeding the width will be hidden.</p><details class="note success"><summary><p>StackPanel Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">StackPanel</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Height</span>=<span class="string">&quot;60&quot;</span> &lt;!<span class="attr">--</span> <span class="attr">Set</span> <span class="attr">height</span> <span class="attr">--</span>&gt;</span></span><br><span class="line">    HorizontalAlignment=&quot;Left&quot; //Set horizontal alignment</span><br><span class="line">    VerticalAlignment=&quot;Center&quot; //Set vertical alignment</span><br><span class="line">    Orientation=&quot;Horizontal&quot;&gt; //Set orientation</span><br><span class="line">    <span class="tag">&lt;<span class="name">Label</span> <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">AccessText</span> <span class="attr">Text</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Label</span> <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">AccessText</span> <span class="attr">Text</span>=<span class="string">&quot;2&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br></pre></td></tr></table></figure></details><h2 id="Material-Design"><a href="#Material-Design" class="headerlink" title="Material Design"></a>Material Design</h2><p>Initially, I thought about crafting my own UI styles, but as I delved deeper, I realized how naive I was. Dealing with things like rounded corner radii and button animations was quite overwhelming. So, I decided to take a different approach and use a UI framework directly in my program. The advantages of this approach are that it’s time-saving and visually appealing, but the downside is that the file size of the program after packaging might increase. After pondering for a while, I ultimately settled on <a target="_blank" rel="noopener" href="https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit">Material Design In XAML</a>.</p><h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><p>In <code>App.xaml</code>, I added a new namespace reference: <code>xmlns:materialDesign=&quot;http://materialdesigninxaml.net/winfx/xaml/themes&quot;</code>, and then I added a few <code>ResourceDictionary</code> entries.</p><details class="note success"><summary><p>App.xaml</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Application</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x:Class</span>=<span class="string">&quot;[PackageName].App&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:x</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:local</span>=<span class="string">&quot;clr-namespace:[PackageName]&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:materialDesign</span>=<span class="string">&quot;http://materialdesigninxaml.net/winfx/xaml/themes&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">StartupUri</span>=<span class="string">&quot;MainWindow.xaml&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Application.Resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ResourceDictionary</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ResourceDictionary.MergedDictionaries</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ResourceDictionary</span> <span class="attr">Source</span>=<span class="string">&quot;pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Light.xaml&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ResourceDictionary</span> <span class="attr">Source</span>=<span class="string">&quot;pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Defaults.xaml&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ResourceDictionary</span> <span class="attr">Source</span>=<span class="string">&quot;pack://application:,,,/MaterialDesignColors;component/Themes/Recommended/Primary/MaterialDesignColor.DeepPurple.xaml&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ResourceDictionary</span> <span class="attr">Source</span>=<span class="string">&quot;pack://application:,,,/MaterialDesignColors;component/Themes/Recommended/Accent/MaterialDesignColor.Lime.xaml&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ResourceDictionary.MergedDictionaries</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ResourceDictionary</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Application.Resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Application</span>&gt;</span></span><br></pre></td></tr></table></figure></details><p>Then, in each XAML file corresponding to a window, I added namespace references and related attributes (optional) within the Window tag.</p><details class="note success"><summary><p>Window Tag</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Window</span></span></span><br><span class="line"><span class="tag">    // <span class="attr">Existing</span> <span class="attr">content</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:materialDesign</span>=<span class="string">&quot;http://materialdesigninxaml.net/winfx/xaml/themes&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">TextElement.Foreground</span>=<span class="string">&quot;&#123;DynamicResource MaterialDesignBody&#125;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Background</span>=<span class="string">&quot;&#123;DynamicResource MaterialDesignPaper&#125;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">TextElement.FontWeight</span>=<span class="string">&quot;Medium&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">TextElement.FontSize</span>=<span class="string">&quot;14&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">FontFamily</span>=<span class="string">&quot;&#123;materialDesign:MaterialDesignFont&#125;&quot;</span></span></span><br><span class="line"><span class="tag">    // <span class="attr">Other</span> <span class="attr">content</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Window</span>&gt;</span></span><br></pre></td></tr></table></figure></details><h2 id="Window-Style"><a href="#Window-Style" class="headerlink" title="Window Style"></a>Window Style</h2><p>Because I wanted to achieve a borderless window (I’m both inexperienced and adventurous🐶), I set the <code>WindowStyle</code> attribute to <code>None</code> within the Window tag. The advantage of doing this is the freedom it offers in designing the window style according to your preferences. However, the drawback is that this approach is overly flexible – functionalities like close, minimize, and others need to be implemented from scratch, and the native Windows animation effects are lost.</p><h3 id="Function-Buttons"><a href="#Function-Buttons" class="headerlink" title="Function Buttons"></a>Function Buttons</h3><p>First, in the <code>MainWindow.xaml</code> file, I redesigned the top bar. On the left is the application title, and on the right are the function buttons: Settings, Minimize, and Close. Then, I bound the <code>Click</code> events to the buttons.</p><details class="note success"><summary><p>Close Button Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--MainWindow.xaml Example of Close Button--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x:Name</span>=<span class="string">&quot;CloseButton&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Width</span>=<span class="string">&quot;30&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Height</span>=<span class="string">&quot;30&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Margin</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Click</span>=<span class="string">&quot;CloseButton_Click&quot;</span> //<span class="attr">Bind</span> <span class="attr">the</span> <span class="attr">close</span> <span class="attr">event</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Style</span>=<span class="string">&quot;&#123;StaticResource MaterialDesignFloatingActionMiniButton&#125;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">WindowChrome.IsHitTestVisibleInChrome</span>=<span class="string">&quot;True&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">materialDesign:PackIcon</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Width</span>=<span class="string">&quot;25&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Height</span>=<span class="string">&quot;25&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Kind</span>=<span class="string">&quot;Close&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br></pre></td></tr></table></figure></details><p>Finally, in <code>MainWindow.xaml.cs</code>, I re-implemented the button functionalities:</p><ul><li>Close the window: <code>Close()</code></li><li>Minimize: <code>this.WindowState = WindowState.Minimized</code></li><li>Drag the window: <code>DragMove()</code></li></ul><details class="note success"><summary><p>Close Window Example</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MainWindow.xaml.cs Example of Close Window</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CloseButton_Click</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Close(); <span class="comment">// Close the window</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="Window-Shadow"><a href="#Window-Shadow" class="headerlink" title="Window Shadow"></a>Window Shadow</h3><p>To achieve the shadow effect, it’s necessary to allow window transparency and set the window background to a null value.</p><details class="note success"><summary><p>MainWindow.xaml Relevant Tags Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Window</span></span></span><br><span class="line"><span class="tag">    // <span class="attr">Other</span> <span class="attr">content</span></span></span><br><span class="line"><span class="tag">    <span class="attr">AllowsTransparency</span>=<span class="string">&quot;True&quot;</span> //<span class="attr">Allow</span> <span class="attr">transparency</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Background</span>=<span class="string">&quot;&#123;x:Null&#125;&quot;</span> //<span class="attr">Set</span> <span class="attr">background</span> <span class="attr">to</span> <span class="attr">null</span></span></span><br><span class="line"><span class="tag">    <span class="attr">WindowStyle</span>=<span class="string">&quot;None&quot;</span> //<span class="attr">Disable</span> <span class="attr">the</span> <span class="attr">default</span> <span class="attr">Windows</span> <span class="attr">window</span> <span class="attr">style</span></span></span><br><span class="line"><span class="tag">    // <span class="attr">Other</span> <span class="attr">content</span>&gt;</span></span><br></pre></td></tr></table></figure></details><p>Below are two incorrect examples. In the left image, window transparency wasn’t allowed, resulting in a black border around the window. In the right image, the background was set to red.</p><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://s2.loli.net/2023/08/18/G7k3ueC45sLVzPF.png" alt="bpc_shadow2.png"></div><div class="group-picture-column"><img data-src="https://s2.loli.net/2023/08/18/GuCkMH4gx7ldKPZ.png" alt="bpc_shadow1.png"></div></div></div><p>For the shadow effect, I used the <code>DropShadowEffect</code> within the Grid.</p><details class="note success"><summary><p>DropShadowEffect Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Grid.Effect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DropShadowEffect</span></span></span><br><span class="line"><span class="tag">        <span class="attr">BlurRadius</span>=<span class="string">&quot;15&quot;</span> //<span class="attr">The</span> <span class="attr">radius</span> <span class="attr">of</span> <span class="attr">the</span> <span class="attr">shadow</span> <span class="attr">blur</span> <span class="attr">effect</span>, <span class="attr">default</span> <span class="attr">value</span> <span class="attr">is</span> <span class="attr">5</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Opacity</span>=<span class="string">&quot;0.8&quot;</span> //<span class="attr">The</span> <span class="attr">higher</span> <span class="attr">the</span> <span class="attr">value</span>, <span class="attr">the</span> <span class="attr">more</span> <span class="attr">pronounced</span> <span class="attr">the</span> <span class="attr">shadow</span></span></span><br><span class="line"><span class="tag">        <span class="attr">ShadowDepth</span>=<span class="string">&quot;0&quot;</span> //<span class="attr">The</span> <span class="attr">distance</span> <span class="attr">of</span> <span class="attr">the</span> <span class="attr">shadow</span> <span class="attr">from</span> <span class="attr">the</span> <span class="attr">window</span>; <span class="attr">as</span> <span class="attr">this</span> <span class="attr">value</span> <span class="attr">increases</span>, <span class="attr">the</span> <span class="attr">shadow</span> <span class="attr">moves</span> <span class="attr">to</span> <span class="attr">the</span> <span class="attr">lower</span> <span class="attr">right</span> <span class="attr">of</span> <span class="attr">the</span> <span class="attr">window</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Color</span>=<span class="string">&quot;#666666&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Grid.Effect</span>&gt;</span></span><br></pre></td></tr></table></figure></details><p>At this point, the shadow won’t be visible because it surrounds the Grid from the outside, and the current Grid already occupies the entire window space. Consequently, the shadow remains invisible. To fix this, we need to set an outer margin for the Grid using the <code>Margin</code> property. The specific margin value should be based on the width of the shadow.</p><h3 id="Window-Rounded-Corners"><a href="#Window-Rounded-Corners" class="headerlink" title="Window Rounded Corners"></a>Window Rounded Corners</h3><p>There are multiple ways to achieve rounded corner effects. We can use <code>UniformCornerRadius=&quot;radius&quot;</code> within a Card to uniformly set the radii for all four corners, or we can use <code>CornerRadius=&quot;topLeft, topRight, bottomRight, bottomLeft&quot;</code> within a Border to set radii for each corner separately. I opted for the Card approach and set the corner radius to 15.</p><details class="note success"><summary><p>Window Rounded Corners Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">materialDesign:Card</span> <span class="attr">Background</span>=<span class="string">&quot;&#123;DynamicResource CardBackgroundColor&#125;&quot;</span> <span class="attr">UniformCornerRadius</span>=<span class="string">&quot;15&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></details><h3 id="Window-Animation"><a href="#Window-Animation" class="headerlink" title="Window Animation"></a>Window Animation</h3><p>There are four animations that need to be re-implemented: window startup, window close, minimize, and restore from minimize.</p><ul><li>Window startup: Mimicking the native Windows animation.</li><li>Window close: Mimicking the native Windows animation.</li><li>Minimize: The window slides downward while gradually decreasing opacity.</li><li>Restore from minimize: The window slides upward from the bottom while gradually increasing opacity.</li></ul><h4 id="Create-Animations"><a href="#Create-Animations" class="headerlink" title="Create Animations"></a>Create Animations</h4><p>The native Windows startup animation involves the gradual increase of window opacity and the gradual expansion of the window from 0.7-0.8 times its size outward to its normal size. The window close animation is the reverse of this. I’ll illustrate how to create the animation for window startup. To achieve a similar effect, we need to create a <code>Storyboard</code> and add three <code>DoubleAnimation</code> instances to it for opacity change, horizontal stretch, and vertical stretch.</p><h5 id="Opacity"><a href="#Opacity" class="headerlink" title="Opacity"></a>Opacity</h5><p>Opacity animation is straightforward. The following code demonstrates how to animate the opacity from 0 to 1 when the window starts. Pay attention to the <code>FillBehavior</code> property; its default value is <code>HoldEnd</code>, meaning that the value of <code>To</code> in the animation will overwrite the program’s original value. This can cause issues in certain cases, so the solution is to set it to <code>Stop</code>.</p><details class="note success"><summary><p>Opacity Animation</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DoubleAnimation</span></span></span><br><span class="line"><span class="tag">    <span class="attr">FillBehavior</span>=<span class="string">&quot;Stop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Storyboard.TargetProperty</span>=<span class="string">&quot;Opacity&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">From</span>=<span class="string">&quot;0&quot;</span> //<span class="attr">Initial</span> <span class="attr">opacity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">To</span>=<span class="string">&quot;1&quot;</span> //<span class="attr">Final</span> <span class="attr">opacity</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Duration</span>=<span class="string">&quot;0:0:0.2&quot;</span> //<span class="attr">Animation</span> <span class="attr">duration:</span> <span class="attr">0.2</span> <span class="attr">seconds</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure></details><h5 id="Window-Stretch"><a href="#Window-Stretch" class="headerlink" title="Window Stretch"></a>Window Stretch</h5><p>First, set the <code>x:Name</code> and <code>RenderTransformOrigin</code> properties within the main Grid. <code>x:Name</code> is used for the stretch animation to find the corresponding Grid, while <code>RenderTransformOrigin</code> sets the starting point of the animation. Its values range from 0 to 1; when set to <code>0,0</code>, the animation starts from the upper-left corner of the window, and when set to <code>1,1</code>, it starts from the lower-right corner. Here, I set it to <code>0.5,0.5</code>, which is the center of the window.</p><p>Next, add the <code>RenderTransform</code> property to the Grid. <code>RenderTransform</code> is a property used to apply transformations to an element during rendering. It allows us to apply transformations like translation, scaling, rotation, and skew to change an element’s position, size, and direction during rendering. To make it easier to add other effects later, I used the <code>TransformGroup</code> class, which is a container class in WPF used to combine multiple transformation effects. It allows us to combine translations, scaling, rotation, skew, and more, and apply them all simultaneously to an element.</p><p>The next step is to add the horizontal and vertical stretch animations, using <code>DoubleAnimation</code>, to the previously created <code>Storyboard</code>. Use <code>Storyboard.TargetName</code> to specify the object to be stretched and <code>Storyboard.TargetProperty</code> to specify the type of transformation.</p><details class="note success"><summary><p>Window Stretch Animation</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Window.Resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ResourceDictionary</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Storyboard that loads window animations--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Storyboard</span> <span class="attr">x:Key</span>=<span class="string">&quot;ShowWindow&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--Opacity Animation--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DoubleAnimation</span></span></span><br><span class="line"><span class="tag">                <span class="attr">FillBehavior</span>=<span class="string">&quot;Stop&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Storyboard.TargetProperty</span>=<span class="string">&quot;Opacity&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">From</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">To</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Duration</span>=<span class="string">&quot;0:0:0.2&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--Horizontal Stretch--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DoubleAnimation</span></span></span><br><span class="line"><span class="tag">                <span class="attr">FillBehavior</span>=<span class="string">&quot;Stop&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Storyboard.TargetName</span>=<span class="string">&quot;MainGrid&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Storyboard.TargetProperty</span>=<span class="string">&quot;(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleX)&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">From</span>=<span class="string">&quot;0.8&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">To</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Duration</span>=<span class="string">&quot;0:0:0.2&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--Vertical Stretch--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DoubleAnimation</span></span></span><br><span class="line"><span class="tag">                <span class="attr">FillBehavior</span>=<span class="string">&quot;Stop&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Storyboard.TargetName</span>=<span class="string">&quot;MainGrid&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Storyboard.TargetProperty</span>=<span class="string">&quot;(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleY)&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">From</span>=<span class="string">&quot;0.8&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">To</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Duration</span>=<span class="string">&quot;0:0:0.2&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Storyboard</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ResourceDictionary</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Window.Resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--Target Grid--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Grid</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x:Name</span>=<span class="string">&quot;MainGrid&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Margin</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">RenderTransformOrigin</span>=<span class="string">&quot;0.5,0.5&quot;</span>&gt;</span> <span class="comment">&lt;!--Starting point of window transformation--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Grid.RenderTransform</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">TransformGroup</span>&gt;</span> <span class="comment">&lt;!--Container class--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ScaleTransform</span> <span class="attr">ScaleX</span>=<span class="string">&quot;1&quot;</span> <span class="attr">ScaleY</span>=<span class="string">&quot;1&quot;</span> /&gt;</span> <span class="comment">&lt;!--Scale--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SkewTransform</span> /&gt;</span> <span class="comment">&lt;!--Skew--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RotateTransform</span> /&gt;</span> <span class="comment">&lt;!--Rotate--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TranslateTransform</span> /&gt;</span> <span class="comment">&lt;!--Translate--&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">TransformGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Grid.RenderTransform</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--Other Contents--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br></pre></td></tr></table></figure></details><h4 id="Trigger-Animations"><a href="#Trigger-Animations" class="headerlink" title="Trigger Animations"></a>Trigger Animations</h4><p>Triggering the window loading animation is quite simple; we just need to add a <code>Window.Triggers</code> section in the XAML file.</p><details class="note success"><summary><p>Window.Triggers Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Window.Triggers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">EventTrigger</span> <span class="attr">RoutedEvent</span>=<span class="string">&quot;Loaded&quot;</span>&gt;</span> <span class="comment">&lt;!-- Triggered when the window is loaded --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">BeginStoryboard</span> <span class="attr">Storyboard</span>=<span class="string">&quot;&#123;StaticResource ShowWindow&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">EventTrigger</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Window.Triggers</span>&gt;</span></span><br></pre></td></tr></table></figure></details><p>However, animations like minimizing the window are not quite suitable for direct use with <code>Window.Triggers</code>, as there are some special cases where we need to determine whether to play the animation. Therefore, I triggered these animations in the code. Below is the code used to trigger the animation for restoring the window from minimized state. We need to add the line <code>StateChanged=&quot;Window_StateChanged&quot;</code> to the Window tag in the XAML file to bind the window state change event.</p><details class="note success"><summary><p>Window State Change Code</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Window_StateChanged</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Play the animation to restore the window from minimized state when the opacity is 0 and the size returns to normal.</span></span><br><span class="line">    <span class="comment">// My minimize animation eventually sets the window opacity to 0, which makes it convenient to check here.</span></span><br><span class="line">    <span class="comment">// If we don&#x27;t check the window&#x27;s opacity, the animation will also be triggered when the window regains focus after losing it without being minimized.</span></span><br><span class="line">    <span class="keyword">if</span> (WindowState == WindowState.Normal &amp;&amp; <span class="keyword">this</span>.Opacity == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> story = (Storyboard)<span class="keyword">this</span>.Resources[<span class="string">&quot;MaximizeWindow&quot;</span>];</span><br><span class="line">        story.Begin(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h1 id="Images-and-Audio"><a href="#Images-and-Audio" class="headerlink" title="Images and Audio"></a>Images and Audio</h1><p>I created an “Asset” folder in the root directory to store media resources such as images and audio.</p><h2 id="Application-Icon"><a href="#Application-Icon" class="headerlink" title="Application Icon"></a>Application Icon</h2><p>I designed a simple and straightforward icon – a Bongo Cat holding a mouse cursor. This was done using a few steps in Photoshop. To add the icon, open the project’s <code>Properties</code>, select <code>Resources</code> under the <code>Application</code> menu, then click the <code>Browse</code> button and locate your icon. Icon files must be in the <code>ico</code> format.<br><img data-src="https://s2.loli.net/2023/08/18/ilZkBTWVf9gUxLO.png" alt="bpc_icon.png"></p><h2 id="Bongo-Cat"><a href="#Bongo-Cat" class="headerlink" title="Bongo Cat"></a>Bongo Cat</h2><p>I achieved the effect of Bongo Cat tapping the table in sync with mouse clicks by switching between four images representing different states of Bongo Cat’s paws:</p><ul><li>Default state: Both paws are raised.</li><li>Left mouse button click: The left paw is tapped down.</li><li>Left mouse button double click: Both paws are simultaneously tapped down.</li><li>Right mouse button click: The right paw is tapped down.</li></ul><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://s2.loli.net/2023/08/18/ISOCrNd46uhEwtx.png" alt="nonePaw.png"></div><div class="group-picture-column"><img data-src="https://s2.loli.net/2023/08/18/HGk9cCoqEwtledn.png" alt="leftPaw.png"></div><div class="group-picture-column"><img data-src="https://s2.loli.net/2023/08/18/F364xwoDMdYuNEA.png" alt="rightPaw.png"></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://s2.loli.net/2023/08/18/HVnKk74vDx6oQZW.png" alt="bothPaw.png"></div></div></div><p>First, I prepared the four images in Photoshop, aligning the outlines of Bongo Cat’s body and exporting them to files of the same size. I then placed them all within the same canvas and set them to the same size and alignment. The <code>Visibility</code> property of the three images, except for the default state image, was set to <code>&quot;Collapsed&quot;</code>.</p><details class="note primary"><summary><p>Visibility Property</p></summary><p><code>Visibility</code> property controls the visibility of an element on the interface. In WPF, the <code>Visibility</code> property can have three possible values: <code>Visible</code>, <code>Collapsed</code>, and <code>Hidden</code>.</p><ol><li><strong>Visible</strong>: The element is visible and occupies layout space. It is displayed on the interface and responds to user interaction.</li><li><strong>Collapsed</strong>: The element is invisible and doesn’t occupy layout space. It won’t appear on the interface and won’t take up any space. Unlike <code>Visible</code>, when set to <code>Collapsed</code>, the element doesn’t leave any whitespace, and the surrounding layout becomes compact.</li><li><strong>Hidden</strong>: The element is invisible but still occupies layout space. Similar to <code>Visible</code>, the element won’t be visible, but it still occupies space, preventing the surrounding layout from compacting.</li></ol><p>In general, if you want to completely hide an element and want the surrounding layout to rearrange to fill its place, you can use <code>Collapsed</code>. If you want the element to be hidden but still occupy space, you can use <code>Hidden</code>.</p></details><p>Next, I handled the interactions in the code. For instance, for a left mouse button single click, when simulating the click event, I set the left paw’s “Visible” property to true and collapsed the default state image. After a 100-millisecond delay, I restored the original state by collapsing the left paw and making the default state image visible again.</p><details class="note success"><summary><p>Left Mouse Click Example</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (clickType == <span class="number">0</span>) <span class="comment">// Left mouse button click</span></span><br><span class="line">&#123;</span><br><span class="line">    Dispatcher.InvokeAsync((Action)(<span class="keyword">async</span> () =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        LeftPaw.Visibility = Visibility.Visible;</span><br><span class="line">        NonePaw.Visibility = Visibility.Collapsed;</span><br><span class="line">        <span class="keyword">await</span> Task.Delay(<span class="number">100</span>);</span><br><span class="line">        LeftPaw.Visibility = Visibility.Collapsed;</span><br><span class="line">        NonePaw.Visibility = Visibility.Visible;</span><br><span class="line">    &#125;));</span><br><span class="line">    User32API.ClickOnScreen(<span class="number">0</span>, xCoord, yCoord); <span class="comment">// Simulate a click</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>When a user interrupts the execution of the click event, the image switching might be interrupted, and the currently displayed image might not be the default state image. Therefore, after the simulation click command is interrupted or ends, we need to restore the images to their default state.</p><h2 id="Play-Audio"><a href="#Play-Audio" class="headerlink" title="Play Audio"></a>Play Audio</h2><p>When adding audio, I encountered an interesting issue. If we use <code>MediaPlayer</code> directly in XAML, we need to use an absolute path to the audio file when calling it in the code. Using a relative path will result in a resource not found error. In the end, I added the audio file to <code>Resources.resx</code> and successfully called it using <code>Properties.Resources.[FileName]</code>.</p><details class="note success"><summary><p>Audio Playback Code</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">MainWindow</span> : <span class="title">Window</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Audio player</span></span><br><span class="line">    System.Media.SoundPlayer meowAudio;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Load audio when the window is loaded</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Window_Loaded</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        meowAudio = <span class="keyword">new</span> System.Media.SoundPlayer(Properties.Resources.meow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Play audio after simulating a click</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ClickLuncher</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Dispatcher.InvokeAsync((Action)(() =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            meowAudio.Play();</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>Here’s another tricky part: by default, <code>Resources.resx</code> shows the resource type as “String”. We need to switch it to “Audio” from the dropdown menu in the top-left corner. We also need to click a very small and subtle arrow to open the dropdown menu, as shown in the image below.</p><p><img data-src="https://s2.loli.net/2023/08/18/G1knqmbt7juEM2x.png" alt="bpc_audio.png"></p><details class="note primary"><summary><p>UI Thread and Dispatcher</p></summary><p>You might have noticed the use of <code>Dispatcher</code> for switching cat paw images in the code. This relates to the issue of the UI thread.</p><h2 id="UI-Thread"><a href="#UI-Thread" class="headerlink" title="UI Thread"></a>UI Thread</h2><p>The UI thread is responsible for handling user interface interactions and updates. In WPF applications, the UI thread is responsible for creating, displaying, interacting with, and updating user interface elements such as windows, buttons, text boxes, and more. The UI thread is responsible for rendering the interface, responding to user input, and handling various UI events.</p><p>The importance of the UI thread lies in its thread context. Most UI frameworks, including WPF, require all UI-related operations to be performed on the same thread to ensure thread safety. This means you can’t directly update UI elements on a non-UI thread, as it might lead to cross-thread issues.</p><p>Some characteristics of the UI thread include:</p><ul><li>Single-threaded model: In most UI frameworks, including WPF, the UI thread follows a single-threaded model. This means all UI element creation, modification, and interaction must be performed on the same UI thread.</li><li>User interface operations: The UI thread is responsible for handling various user interface operations, including responding to user input, processing mouse and keyboard events, handling window state changes (maximize, minimize, etc.).</li><li>Rendering and drawing: The UI thread is responsible for rendering and drawing user interface elements, ensuring they are correctly displayed on the screen.</li><li>Responsiveness: To maintain the responsiveness of an application, the UI thread should remain lightweight to promptly respond to user actions.</li><li>Thread safety: Operations on the UI thread must be thread-safe to avoid concurrency and synchronization issues.</li></ul><p>When performing lengthy calculations or time-consuming operations, these tasks should be offloaded to non-UI threads to maintain UI smoothness. However, when updating UI elements, you still need to use the <code>Dispatcher</code> to dispatch operations to the UI thread to ensure thread safety.</p><h2 id="Dispatcher"><a href="#Dispatcher" class="headerlink" title="Dispatcher"></a>Dispatcher</h2><p>The <code>Dispatcher</code> is a mechanism in WPF that allows you to schedule operations on the UI thread from a non-UI thread. By using the <code>Dispatcher</code>, you ensure that UI element updates and operations occur on the correct thread, avoiding thread safety issues.</p><p>For instance, if you’re performing a calculation on a background thread and want to display the result on the UI, you need to use the <code>Dispatcher</code> to send the update operation to the UI thread. This ensures that UI element updates don’t lead to cross-thread problems.</p><p>The <code>Dispatcher</code> offers three commonly used methods: <code>Invoke</code>, <code>BeginInvoke</code>, and <code>InvokeAsync</code>.</p><ul><li><code>Invoke</code> is a synchronous method, which means the calling thread will be blocked until the operation is completed on the UI thread.</li><li>Both <code>BeginInvoke</code> and <code>InvokeAsync</code> are asynchronous methods. They enqueue the operation to the UI thread’s message queue and return immediately without blocking the calling thread, allowing it to continue executing subsequent code. <code>InvokeAsync</code> was introduced in <code>.NET Framework 4.5</code>. The main difference between the two is how they handle exceptions. <code>InvokeAsync</code> is preferred, especially when you need to use the <code>await</code> method.</li></ul></details><h1 id="Settings-Panel"><a href="#Settings-Panel" class="headerlink" title="Settings Panel"></a>Settings Panel</h1><p>I created a separate window for the settings panel within the program. The settings panel provides the following functionalities:</p><ul><li>Toggle between light and dark themes for the application.</li><li>Set whether the application should always stay on top.</li><li>Configure hotkeys.</li><li>Define reminders after completing clicks.</li></ul><h2 id="Create-the-Window"><a href="#Create-the-Window" class="headerlink" title="Create the Window"></a>Create the Window</h2><p>To begin, I added a button in the XAML file of the main window and bound it to the <code>Click</code> event <code>Click=&quot;SettingButton_Click&quot;</code>. Then, I added a new window to the project and named it <code>SettingPanel</code>. Next, I opened the code file of the main window and edited the automatically generated method code.<br><img data-src="https://s2.loli.net/2023/08/18/iVex1vswbLakocI.png" alt="bpc_sp1.png"></p><details class="note success"><summary><p>Creating the Settings Window</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SettingButton_Click</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    SettingPanel settingPanel = <span class="keyword">new</span> SettingPanel(); <span class="comment">// Create the settings window</span></span><br><span class="line">    settingPanel.WindowStartupLocation = WindowStartupLocation.CenterOwner; <span class="comment">// Set the window startup location to the center of the owner window</span></span><br><span class="line">    settingPanel.Owner = <span class="keyword">this</span>; <span class="comment">// Set the main window as the owner of the settings window</span></span><br><span class="line">    settingPanel.ShowDialog(); <span class="comment">// Show the settings window</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details class="note primary"><summary><p>ShowDialog and Show</p></summary><h2 id="ShowDialog-and-Show"><a href="#ShowDialog-and-Show" class="headerlink" title="ShowDialog and Show"></a>ShowDialog and Show</h2><p>In WPF, Show and ShowDialog are two different ways to display windows.</p><h3 id="Show"><a href="#Show" class="headerlink" title="Show"></a>Show</h3><ul><li>Windows displayed using the Show method are non-modal, meaning they do not prevent interaction with other parts of the application.</li><li>Users can freely switch between open windows, and even interact between the main window and other open windows.</li><li>The Show method returns immediately, without waiting for the opened window to close.</li></ul><h3 id="ShowDialog"><a href="#ShowDialog" class="headerlink" title="ShowDialog"></a>ShowDialog</h3><ul><li>Windows displayed using the ShowDialog method are modal, meaning they prevent interaction with other parts of the application until the window is closed.</li><li>Users must close the modal window before returning to the main window or other open windows.</li><li>The ShowDialog method returns after the opened window is closed, making it suitable for implementing dialogs that require user response.</li></ul></details><h1 id="Theme-Switch"><a href="#Theme-Switch" class="headerlink" title="Theme Switch"></a>Theme Switch</h1><p>During late-night testing, I found the default light theme too harsh on the eyes. So, I decided to add a dark theme option with a button in the settings window for theme switching.</p><p><code>Material Design</code> comes with built-in light and dark themes, as well as several sets of primary color schemes. The <code>Primary Color</code> further divides into Light, Normal, and Dark variants. Components like TextBox and ToggleButton use the Light variant, while Buttons use the Dark variant. I was dissatisfied with the Light variant’s color scheme, so I added a custom color scheme using resource dictionaries. I used my own color scheme for the window background, toggle buttons, etc., while using the default <code>Material Design</code> colors for regular buttons.</p><p>First, I added two <code>SolidColorBrush</code> properties in the <code>App.xaml</code> file. <code>CardBackgroundColor</code> represents the window’s background color, while <code>IndicatorColor</code> represents the theme color for various controls. By default, it is set to the light theme.</p><details class="note success"><summary><p>SolidColorBrush Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Application.Resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ResourceDictionary</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SolidColorBrush</span> <span class="attr">x:Key</span>=<span class="string">&quot;CardBackgroundColor&quot;</span>&gt;</span>#f8f8ff<span class="tag">&lt;/<span class="name">SolidColorBrush</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SolidColorBrush</span> <span class="attr">x:Key</span>=<span class="string">&quot;IndicatorColor&quot;</span>&gt;</span>#b39ddb<span class="tag">&lt;/<span class="name">SolidColorBrush</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Other resources --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ResourceDictionary</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Application.Resources</span>&gt;</span></span><br></pre></td></tr></table></figure></details><p>Then, in the <code>SettingPanel.xaml</code>, I added a toggle button with <code>Checked</code> and <code>Unchecked</code> events bound to methods for turning on and off the dark mode.</p><details class="note success"><summary><p>Toggle Button Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ToggleButton</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x:Name</span>=<span class="string">&quot;DarkModeToggleButton&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Margin</span>=<span class="string">&quot;10,0,0,0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Background</span>=<span class="string">&quot;&#123;DynamicResource IndicatorColor&#125;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Checked</span>=<span class="string">&quot;DarkModeToggleButton_Checked&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Effect</span>=<span class="string">&quot;&#123;StaticResource MaterialDesignElevationShadow2&#125;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Style</span>=<span class="string">&quot;&#123;StaticResource MaterialDesignSwitchLightToggleButton&#125;&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Unchecked</span>=<span class="string">&quot;DarkModeToggleButton_Unchecked&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></details><p>Next, I edited the corresponding methods in <code>SettingPanel.xaml.cs</code>. Initially, I placed all the theme-switching code in the settings window. However, I noticed that clicking the toggle button only changed the settings window’s theme, and the main window only switched to the default Material Design dark theme. My custom colors scheme didn’t change. I realized I needed to force a refresh of <code>Dynamic Resources</code> in the main window to change the custom colors. So for the sake of convenience, I just moved the theme-switching code to the main window.</p><details class="note success"><summary><p>Code in Setting Window</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SettingPanel.xaml.cs</span></span><br><span class="line"><span class="comment">//Force the current window to refresh Dynamic Resources</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Switch to dark theme</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DarkModeToggleButton_Checked</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (Owner <span class="keyword">is</span> MainWindow mainWindow)</span><br><span class="line">    &#123;</span><br><span class="line">        mainWindow.SwitchToDarkMode();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Force the current window to refresh Dynamic Resources</span></span><br><span class="line">    Resources[<span class="string">&quot;CardBackgroundColor&quot;</span>] = <span class="keyword">new</span> SolidColorBrush((Color)ColorConverter.ConvertFromString(<span class="string">&quot;#3d3d3d&quot;</span>));</span><br><span class="line">    Resources[<span class="string">&quot;IndicatorColor&quot;</span>] = <span class="keyword">new</span> SolidColorBrush((Color)ColorConverter.ConvertFromString(<span class="string">&quot;#ffb330&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Switch to light theme</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DarkModeToggleButton_Unchecked</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (Owner <span class="keyword">is</span> MainWindow mainWindow)</span><br><span class="line">    &#123;</span><br><span class="line">        mainWindow.SwitchToLightMode();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Force the current window to refresh Dynamic Resources</span></span><br><span class="line">    Resources[<span class="string">&quot;CardBackgroundColor&quot;</span>] = <span class="keyword">new</span> SolidColorBrush((Color)ColorConverter.ConvertFromString(<span class="string">&quot;#f8f8ff&quot;</span>));</span><br><span class="line">    Resources[<span class="string">&quot;IndicatorColor&quot;</span>] = <span class="keyword">new</span> SolidColorBrush((Color)ColorConverter.ConvertFromString(<span class="string">&quot;#b39ddb&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details class="note success"><summary><p>Code in Main Window</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MainWindow.xaml.cs</span></span><br><span class="line"><span class="comment">//Main code for theme switching</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Switch to dark mode</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SwitchToDarkMode</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> paletteHelper = <span class="keyword">new</span> PaletteHelper();</span><br><span class="line">    <span class="comment">//Get the primary color Amber from the built-in theme provided by Material Design</span></span><br><span class="line">    PrimaryColor primary = PrimaryColor.Amber;</span><br><span class="line">    Color primaryColor = SwatchHelper.Lookup[(MaterialDesignColor)primary];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Switch to a custom color scheme: Dark gray for background and gold for components</span></span><br><span class="line">    Resources[<span class="string">&quot;CardBackgroundColor&quot;</span>] = <span class="keyword">new</span> SolidColorBrush((Color)ColorConverter.ConvertFromString(<span class="string">&quot;#3d3d3d&quot;</span>));</span><br><span class="line">    Resources[<span class="string">&quot;IndicatorColor&quot;</span>] = <span class="keyword">new</span> SolidColorBrush((Color)ColorConverter.ConvertFromString(<span class="string">&quot;#ffb330&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Switch to the built-in dark theme provided by Material Design</span></span><br><span class="line">    ITheme theme = paletteHelper.GetTheme();</span><br><span class="line">    theme.SetBaseTheme(Theme.Dark);</span><br><span class="line">    theme.SetPrimaryColor(primaryColor);</span><br><span class="line">    paletteHelper.SetTheme(theme);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Switch to light mode</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SwitchToLightMode</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> paletteHelper = <span class="keyword">new</span> PaletteHelper();</span><br><span class="line">    <span class="comment">//Get the primary color DeepPurple from the built-in theme provided by Material Design</span></span><br><span class="line">    PrimaryColor primary = PrimaryColor.DeepPurple;</span><br><span class="line">    Color primaryColor = SwatchHelper.Lookup[(MaterialDesignColor)primary];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Switch to a custom color scheme: Light gray for background and light purple for components</span></span><br><span class="line">    Resources[<span class="string">&quot;CardBackgroundColor&quot;</span>] = <span class="keyword">new</span> SolidColorBrush((Color)ColorConverter.ConvertFromString(<span class="string">&quot;#f8f8ff&quot;</span>));</span><br><span class="line">    Resources[<span class="string">&quot;IndicatorColor&quot;</span>] = <span class="keyword">new</span> SolidColorBrush((Color)ColorConverter.ConvertFromString(<span class="string">&quot;#b39ddb&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Switch to the built-in light theme provided by Material Design</span></span><br><span class="line">    ITheme theme = paletteHelper.GetTheme();</span><br><span class="line">    theme.SetBaseTheme(Theme.Light);</span><br><span class="line">    theme.SetPrimaryColor(primaryColor);</span><br><span class="line">    paletteHelper.SetTheme(theme);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>Finally, set the <code>Background=&quot;&#123;DynamicResource IndicatorColor&#125;&quot;</code> or <code>BorderBrush=&quot;&#123;DynamicResource IndicatorColor&#125;&quot;</code> attribute to the components that require the application of the custom colour scheme, instead of using Material Design’s <code>Primary Color</code>.</p><h1 id="Simulate-Mouse-Clicks"><a href="#Simulate-Mouse-Clicks" class="headerlink" title="Simulate Mouse Clicks"></a>Simulate Mouse Clicks</h1><p>Simulating mouse clicks involves using the <code>user32.dll</code>. <code>user32.dll</code> is a core DLL in the Windows operating system and contains many functions related to user interface, such as creating windows, displaying message boxes, handling input, etc. To call <code>user32.dll</code> in a .NET program, you need to use <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/dotnet/standard/native-interop/pinvoke">P&#x2F;Invoke（Platform Invocation Services）</a> with the <code>[DllImport(&quot;user32.dll&quot;)]</code> attribute, and the method signature includes the <code>extern</code> keyword to indicate it’s an external method.</p><p>I created a class named <code>User32API.cs</code> to store code related to <code>user32.dll</code>. Simulating a click involves two steps: first, using the <code>SetCursorPos</code> function to move the cursor to the specified screen coordinates, and second, using the <code>mouse_event</code> function to perform the actual click based on the specified click type.</p><h2 id="SetCursorPos"><a href="#SetCursorPos" class="headerlink" title="SetCursorPos"></a>SetCursorPos</h2><p>The <code>SetCursorPos</code> function moves the mouse cursor to the specified screen coordinates. The function prototype is as follows:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">SetCursorPos</span><span class="params">(<span class="type">int</span> X, <span class="type">int</span> Y)</span>;</span><br></pre></td></tr></table></figure><p>Parameter explanation:</p><ul><li>X: The X-coordinate value in screen pixel units, representing the horizontal position.</li><li>Y: The Y-coordinate value in screen pixel units, representing the vertical position.</li></ul><p>After calling this function, the mouse cursor will be moved to the specified coordinates, regardless of whether the mouse is inside an active window. Additionally, this function doesn’t show the movement visually.</p><p>If the provided X or Y values are outside the screen boundaries, the system limits the mouse position to the visible area of the screen. For example, if you set X to a negative value, the system will set it to the left boundary, and if you set X to a value greater than the screen width, the system will set it to the right boundary. The same logic applies to the Y value.</p><details class="note success"><summary><p>SetCursorPos Example</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">DllImport(<span class="string">&quot;user32.dll&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> <span class="built_in">int</span> <span class="title">SetCursorPos</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span>;</span><br></pre></td></tr></table></figure></details><h2 id="mouse-event"><a href="#mouse-event" class="headerlink" title="mouse_event"></a>mouse_event</h2><p>The <code>mouse_event</code> function simulates mouse operations such as clicks, movements, scrolling, etc. The function prototype is as follows:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VOID <span class="title function_">mouse_event</span><span class="params">(</span></span><br><span class="line"><span class="params">  DWORD     dwFlags,</span></span><br><span class="line"><span class="params">  DWORD     dx,</span></span><br><span class="line"><span class="params">  DWORD     dy,</span></span><br><span class="line"><span class="params">  DWORD     dwData,</span></span><br><span class="line"><span class="params">  ULONG_PTR dwExtraInfo</span></span><br><span class="line"><span class="params">)</span>;</span><br></pre></td></tr></table></figure><p>Parameter explanation:</p><ul><li>dwFlags: Flags representing the type of mouse operation, indicating the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-mouse_event">action type</a> (e.g., click, move, scroll, etc.).<ul><li><details class="note success"><summary><p>Common Action Types</p></summary><table><thead><tr><th align="left">Type</th><th align="left">Value</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">MOUSEEVENTF_ABSOLUTE</td><td align="left">0x8000</td><td align="left">Absolute coordinate flag</td></tr><tr><td align="left">MOUSEEVENTF_LEFTDOWN</td><td align="left">0x0002</td><td align="left">Left button down</td></tr><tr><td align="left">MOUSEEVENTF_LEFTUP</td><td align="left">0x0004</td><td align="left">Left button up</td></tr><tr><td align="left">MOUSEEVENTF_RIGHTDOWN</td><td align="left">0x0008</td><td align="left">Right button down</td></tr><tr><td align="left">MOUSEEVENTF_RIGHTUP</td><td align="left">0x0010</td><td align="left">Right button up</td></tr></tbody></table></details></li></ul></li><li>There are two uses for <code>dx</code> and <code>dy</code><ul><li>If you use the <code>MOUSEEVENTF_ABSOLUTE</code> flag, <code>dx</code> and <code>dy</code> are interpreted as absolute screen coordinates. In this case, their values typically range from 0 to 65535. This is because the screen coordinate system usually has a range of 0 to 65535, where (0, 0) represents the top-left corner of the screen, and (65535, 65535) represents the bottom-right corner. If you want to simulate absolute mouse movement on the screen, you need to use absolute coordinate values.<ul><li><details class="note success"><summary><p>Example: Move the mouse to the center of the screen</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> screenWidth = <span class="number">1920</span>;</span><br><span class="line"><span class="built_in">int</span> screenHeight = <span class="number">1080</span>;</span><br><span class="line"><span class="built_in">int</span> centerX = (screenWidth * <span class="number">65535</span>) / <span class="number">2</span>;</span><br><span class="line"><span class="built_in">int</span> centerY = (screenHeight * <span class="number">65535</span>) / <span class="number">2</span>;</span><br><span class="line">mouse_event(MOUSEEVENTF_MOVE | MOUSEEVENTF_ABSOLUTE, centerX, centerY, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure></details></li></ul></li><li>If you don’t use the <code>MOUSEEVENTF_ABSOLUTE</code> flag, <code>dx</code> and <code>dy</code> are interpreted as relative movement in pixels. In this case, their values usually range from a signed 16-bit integer, where negative values indicate left or upward movement, and positive values indicate right or downward movement.</li></ul></li><li>dwData is used to indicate the scroll distance for mouse scrolling. A positive value means scrolling up, while a negative value means scrolling down. If the <code>dwFlags</code> does not include a mouse scroll event, set this to 0.</li><li>dwExtraInfo represents additional information, usually set to 0.</li></ul><details class="note success"><summary><p>Simulating Clicks Example</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">int</span> MOUSEEVENT_LEFTDOWN = <span class="number">0x0002</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">int</span> MOUSEEVENTF_LEFTUP = <span class="number">0x0004</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">int</span> MOUSEEVENTF_RIGHTDOWN = <span class="number">0x0008</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">int</span> MOUSEEVENTF_RIGHTUP = <span class="number">0x0010</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">int</span> MOUSEEVENTF_ABSOLUTE = <span class="number">0x8000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Simulate a right-click</span></span><br><span class="line">mouse_event(MOUSEEVENTF_RIGHTDOWN | MOUSEEVENTF_RIGHTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Simulate a left-click</span></span><br><span class="line">mouse_event(MOUSEEVENT_LEFTDOWN | MOUSEEVENTF_LEFTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Simulate a left double-click (two consecutive left-clicks)</span></span><br><span class="line">mouse_event(MOUSEEVENT_LEFTDOWN | MOUSEEVENTF_LEFTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">mouse_event(MOUSEEVENT_LEFTDOWN | MOUSEEVENTF_LEFTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure></details><h1 id="Capturing-Mouse-Coordinates"><a href="#Capturing-Mouse-Coordinates" class="headerlink" title="Capturing Mouse Coordinates"></a>Capturing Mouse Coordinates</h1><p>Directly asking users to input coordinates for clicking is not practical because there’s no pixel ruler on the screen to indicate cursor position. Therefore, we need to design a window that displays cursor coordinates in real-time and captures cursor pixel coordinates when the user presses the left mouse button. Additionally, since we’ve added support for random clicking within a specified area, this window should also allow capturing pixel coordinates through rectangle selection.</p><h2 id="Create-New-Window"><a href="#Create-New-Window" class="headerlink" title="Create New Window"></a>Create New Window</h2><ol><li>Create a new window.</li><li>Set the window state to maximise and always on top, and remove the default window style.</li><li>Allow window transparency and set the opacity to 0.5 so that users can see the content behind the window.</li><li>Bind the <code>KeyDown</code> event to close the window when the user presses the <code>Esc</code> key.</li><li>Bind the <code>MouseMove</code> event to update cursor pixel coordinates in real-time.</li><li>Bind the <code>MouseLeftButtonDown</code> and <code>MouseLeftButtonUp</code> events for point and rectangle selection.</li><li>Add two <code>Label</code> elements to display pixel coordinates as the cursor moves.</li><li>Add a <code>Rectangle</code> element for previewing the selected rectangle.</li></ol><details class="note success"><summary><p>Window Tag Example for Capturing Mouse Coordinates</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Window</span></span></span><br><span class="line"><span class="tag">    <span class="attr">AllowsTransparency</span>=<span class="string">&quot;True&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Background</span>=<span class="string">&quot;Gray&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">KeyDown</span>=<span class="string">&quot;PositionSelector_KeyDown&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">MouseLeftButtonDown</span>=<span class="string">&quot;PositionSelectorCanvas_MouseLeftButtonDown&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">MouseLeftButtonUp</span>=<span class="string">&quot;PositionSelectorCanvas_MouseLeftButtonUp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">MouseMove</span>=<span class="string">&quot;PositionSelectorCanvas_MouseMove&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Opacity</span>=<span class="string">&quot;0.5&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Topmost</span>=<span class="string">&quot;True&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">WindowState</span>=<span class="string">&quot;Maximized&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">WindowStyle</span>=<span class="string">&quot;None&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></details><h2 id="Get-Cursor-Coordinates"><a href="#Get-Cursor-Coordinates" class="headerlink" title="Get Cursor Coordinates"></a>Get Cursor Coordinates</h2><p>We can use <code>e.GetPosition(this)</code> to get the coordinates. <code>GetPosition</code> is a method in WPF used to get the local coordinates of the mouse or touch operation relative to a specified element. It returns a <code>Point</code> object, which is a structure representing a 2D coordinate point. It has two properties: <code>X</code> and <code>Y</code>, representing the horizontal and vertical coordinates, respectively. Both <code>Point.X</code> and <code>Point.Y</code> are of type <code>double</code>.</p><p>Note that the coordinates obtained here are local coordinates of the window, not absolute screen pixel coordinates. We need to convert them to screen coordinates using the <code>PointToScreen</code> method. The <code>PointToScreen</code> method takes a <code>Point</code> object representing the coordinate relative to the calling element. It returns a <code>Point</code> object representing the absolute position on the screen.</p><h2 id="Rectangle-Preview-and-Capture"><a href="#Rectangle-Preview-and-Capture" class="headerlink" title="Rectangle Preview and Capture"></a>Rectangle Preview and Capture</h2><p>The preview rectangle needs to update in real-time as the cursor moves. We need to adjust the rectangle’s width and height each time the <code>MouseMove</code> event is triggered. Since the preview box is drawn inside the window, the window local coordinates are used directly here. Additionally, we need to consider the possibility of reverse selection, where the user drags the selection from the bottom-right corner to the top-left corner. Therefore, the length and width of the rectangle needs to be taken as the absolute value of the difference between the coordinates of the two points.</p><p>If the user has enabled clicking within a random range, the program needs to capture two screen coordinates: the starting and ending points of the selection rectangle, i.e., the points where the left mouse button was pressed and released. I used variables <code>w</code> and <code>h</code> to represent the width and height of the rectangle, and their values are the absolute differences between the horizontal and vertical coordinates of the two points.</p><details class="note success"><summary><p>Code for Rectangle Preview and Capture</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Screen Pixel Coordinates</span></span><br><span class="line"><span class="keyword">private</span> Point mouseDownPoint;</span><br><span class="line"><span class="keyword">private</span> Point mouseUpPoint;</span><br><span class="line"><span class="keyword">private</span> Point currentPoint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">bool</span> randomAreaSelection = <span class="literal">false</span>;<span class="comment">//Enable random clicks</span></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">bool</span> isDragging = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Range Parameters</span></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> x = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> y = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> w = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> h = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Local Window Coordinates</span></span><br><span class="line"><span class="keyword">private</span> Point previewRectangleStartPoint;</span><br><span class="line"><span class="keyword">private</span> Point previewRectangleEndPoint;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Left Mouse Button Down</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">PositionSelectorCanvas_MouseLeftButtonDown</span>(<span class="params"><span class="built_in">object</span> sender, MouseButtonEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Starting point of the selection rectangle</span></span><br><span class="line">    mouseDownPoint = PointToScreen(e.GetPosition(<span class="keyword">this</span>));</span><br><span class="line">    x = (<span class="built_in">int</span>)mouseDownPoint.X;</span><br><span class="line">    y = (<span class="built_in">int</span>)mouseDownPoint.Y;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (randomAreaSelection)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//Starting point of the selection preview rectangle</span></span><br><span class="line">        previewRectangleStartPoint = e.GetPosition(<span class="keyword">this</span>);</span><br><span class="line">        isDragging = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//Show preview rectangle</span></span><br><span class="line">        SelectedAreaPreview.Visibility = Visibility.Visible;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Left mouse button up</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">PositionSelectorCanvas_MouseLeftButtonUp</span>(<span class="params"><span class="built_in">object</span> sender, MouseButtonEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (randomAreaSelection)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//Ending point of the selection rectangle</span></span><br><span class="line">        mouseUpPoint = PointToScreen(e.GetPosition(<span class="keyword">this</span>));</span><br><span class="line">        w = (<span class="built_in">int</span>)mouseUpPoint.X - x;</span><br><span class="line">        h = (<span class="built_in">int</span>)mouseUpPoint.Y - y;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//If the user makes a reverse selection, the relevant parameters need to be transformed</span></span><br><span class="line">        <span class="keyword">if</span> (w &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            x += w;</span><br><span class="line">            w *= <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (h &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            y += h;</span><br><span class="line">            h *= <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        isDragging = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//Hide preview rectangle</span></span><br><span class="line">        SelectedAreaPreview.Visibility = Visibility.Hidden;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Mouse Move</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">PositionSelectorCanvas_MouseMove</span>(<span class="params"><span class="built_in">object</span> sender, MouseEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Get the real-time screen coordinates of the cursor and update the contents of the Label.</span></span><br><span class="line">    currentPoint = PointToScreen(e.GetPosition(<span class="keyword">this</span>));</span><br><span class="line">    XCoordsPreview.Content = (<span class="built_in">int</span>)currentPoint.X;</span><br><span class="line">    YCoordsPreview.Content = (<span class="built_in">int</span>)currentPoint.Y;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Preview rectangle drag points</span></span><br><span class="line">    previewRectangleEndPoint = e.GetPosition(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">if</span> (randomAreaSelection &amp;&amp; isDragging)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//Update the preview rectangle</span></span><br><span class="line">        SelectedAreaPreview.Margin = <span class="keyword">new</span> Thickness(</span><br><span class="line">            Math.Min((<span class="built_in">int</span>)previewRectangleStartPoint.X, (<span class="built_in">int</span>)previewRectangleEndPoint.X),</span><br><span class="line">            Math.Min((<span class="built_in">int</span>)previewRectangleStartPoint.Y, (<span class="built_in">int</span>)previewRectangleEndPoint.Y),</span><br><span class="line">            <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        SelectedAreaPreview.Width = Math.Abs((<span class="built_in">int</span>)previewRectangleEndPoint.X - (<span class="built_in">int</span>)previewRectangleStartPoint.X);</span><br><span class="line">        SelectedAreaPreview.Height = Math.Abs((<span class="built_in">int</span>)previewRectangleEndPoint.Y - (<span class="built_in">int</span>)previewRectangleStartPoint.Y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h1 id="Store-User-Configuration"><a href="#Store-User-Configuration" class="headerlink" title="Store User Configuration"></a>Store User Configuration</h1><p>To store user-customized configurations, we need to set the program automatically load and restore these configurations when the program starts, and save them when the program closes, follow these steps:</p><ol><li>Open <code>./Properties/Settings.settings</code>.</li><li>Add the properties you want to save, set their initial values and types.</li><li>In the main window’s XAML, bind the <code>Loaded</code> event to the <code>Window_Loaded</code> event handler.</li><li>In the code, use <code>Properties.Settings.Default.[PropertyName]</code> to read the corresponding properties.</li><li>Before the window is closed, use <code>Properties.Settings.Default.Save();</code> to save the properties.</li></ol><h1 id="Hotkey-Configuration"><a href="#Hotkey-Configuration" class="headerlink" title="Hotkey Configuration"></a>Hotkey Configuration</h1><p>If the user sets a relatively small interval for clicks, they won’t be able to prematurely end the simulated clicks by clicking the stop button. This is because the program will keep moving the cursor to the predefined points. Therefore, it is necessary to implement the functionality of stopping the clicks using hotkeys. Additionally, since the hotkeys of this program might conflict with the hotkeys of other software the user is using, it’s important to provide the ability for users to customize the hotkeys.</p><h2 id="Configuring-Hotkeys"><a href="#Configuring-Hotkeys" class="headerlink" title="Configuring Hotkeys"></a>Configuring Hotkeys</h2><h3 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h3><p>I have added a text box in the settings window to record the key pressed by the user, followed by an “OK” button to trigger subsequent actions.</p><p>The text box needs to be set as read-only and bound to the <code>PreviewKeyDown</code> event. Unlike the regular <code>KeyDown</code> event, the <code>PreviewKeyDown</code> event is a tunneling event that travels down the visual tree from the parent element and then bubbles back up from the target element. The purpose of this event is to allow preprocessing or interception of keyboard events after a key is pressed but before it is released.</p><details class="note success"><summary><p>Text Box Example</p></summary><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextBox</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x:Name</span>=<span class="string">&quot;HotKeyTextBox&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">VerticalContentAlignment</span>=<span class="string">&quot;Center&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">IsReadOnly</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">PreviewKeyDown</span>=<span class="string">&quot;HotKeyTextBox_PreviewKeyDown&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">TextWrapping</span>=<span class="string">&quot;NoWrap&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">VerticalScrollBarVisibility</span>=<span class="string">&quot;Hidden&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></details><h3 id="Preprocess-Keyboard-Events"><a href="#Preprocess-Keyboard-Events" class="headerlink" title="Preprocess Keyboard Events"></a>Preprocess Keyboard Events</h3><p>When the <code>PreviewKeyDown</code> event is triggered, the program will determine whether the key pressed by the user is valid, as there are some special keys that cannot be used as hotkeys and need to be excluded. After processing, the pressed key will be returned as a string and displayed in the text box.</p><p>The keys pressed by the user can be classified into two categories: <code>Key</code> and <code>ModifierKeys</code>. These are both enumerations used for handling keyboard input.</p><ul><li><code>Key</code>: The <code>Key</code> enumeration defines all possible keyboard keys, including letters, numbers, function keys, control keys, and more. This enumeration allows determining which key the user has pressed. Here are some examples of the <code>Key</code> enumeration:<ul><li><code>Key.A</code>: Represents the letter A key</li><li><code>Key.Escape</code>: Represents the Esc key</li><li><code>Key.Enter</code>: Represents the Enter key</li><li><code>Key.Space</code>: Represents the space key</li><li>For a complete list of enumerations, refer to the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.input.key?view=windowsdesktop-7.0">Microsoft official documentation</a></li></ul></li><li><code>ModifierKeys</code>: The <code>ModifierKeys</code> enumeration defines a set of modifier keys that are typically used in combination with other keys to perform specific actions. These modifier keys include Shift, Ctrl, Alt, and the Windows key. Here are some examples of the <code>ModifierKeys</code> enumeration:<ul><li><code>ModifierKeys.None</code>: No modifier keys are pressed</li><li><code>ModifierKeys.Shift</code>: The Shift key is pressed</li><li><code>ModifierKeys.Control</code>: The Ctrl key is pressed</li><li><code>ModifierKeys.Alt</code>: The Alt key is pressed</li></ul></li></ul><p>Because some keys in the <code>Key</code> enumeration are the same as the modifier keys in the <code>ModifierKeys</code> enumeration, these keys need to be excluded.</p><details class="note success"><summary><p>Keyboard Event Preprocessing Code</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Key hotKey;</span><br><span class="line"><span class="keyword">private</span> ModifierKeys hotKeyModifiers;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Keyboard preprocessing events</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HotKeyTextBox_PreviewKeyDown</span>(<span class="params"><span class="built_in">object</span> sender, KeyEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//Determine whether a Key is valid or not</span></span><br><span class="line">        <span class="keyword">if</span> (IsForbiddenKey(e.Key))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// If the key is not valid then the event is prevented from propagating further</span></span><br><span class="line">            e.Handled = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Assigns user-pressed keys to variables</span></span><br><span class="line">        hotKey = e.Key;</span><br><span class="line">        hotKeyModifiers = Keyboard.Modifiers;</span><br><span class="line">        UpdateHotKeyText();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox.Show(ex.ToString(), <span class="string">&quot;Error!&quot;</span>, MessageBoxButton.OK, MessageBoxImage.Error);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Update text box</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">UpdateHotKeyText</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    HotKeyTextBox.Text = <span class="string">$&quot;<span class="subst">&#123;hotKeyModifiers&#125;</span> + <span class="subst">&#123;hotKey&#125;</span>&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="built_in">bool</span> <span class="title">IsForbiddenKey</span>(<span class="params">Key key</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> Enum.IsDefined(<span class="keyword">typeof</span>(ForbiddenKeys), key.ToString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Invalid Key Enumeration</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> ForbiddenKeys</span><br><span class="line">&#123;</span><br><span class="line">    Back,</span><br><span class="line">    Capital, CapsLock,</span><br><span class="line">    Delete, Down,</span><br><span class="line">    End, Enter, Escape,</span><br><span class="line">    Home,</span><br><span class="line">    Insert,</span><br><span class="line">    Left, LeftAlt, LeftCtrl, LeftShift, LWin,</span><br><span class="line">    Next, NumLock,</span><br><span class="line">    PageDown, PageUp, Pause, PrintScreen,</span><br><span class="line">    Return, Right, RightAlt, RightCtrl, RightShift, RWin,</span><br><span class="line">    System,</span><br><span class="line">    Tab,</span><br><span class="line">    Up,</span><br><span class="line">    VolumeDown, VolumeMute, VolumeUp</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure></details><h2 id="Register-x2F-Unregister-Global-Hotkeys"><a href="#Register-x2F-Unregister-Global-Hotkeys" class="headerlink" title="Register&#x2F;Unregister Global Hotkeys"></a>Register&#x2F;Unregister Global Hotkeys</h2><p>The registration and unregistration of global hotkeys also involve the use of <code>user32.dll</code>. The function used for registration is <code>RegisterHotKey</code>, and for unregistration, it’s <code>UnregisterHotKey</code>. It is recommended to register global hotkeys when the program starts and unregister them upon exit to avoid conflicts with hotkeys from other programs.</p><h3 id="RegisterHotKey-Function"><a href="#RegisterHotKey-Function" class="headerlink" title="RegisterHotKey Function"></a>RegisterHotKey Function</h3><p>Purpose: Registers a global hotkey in the operating system that can be defined by the user and can trigger even when the application is running in the background or without focus.</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">DllImport(<span class="string">&quot;user32.dll&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">return: MarshalAs(UnmanagedType.Bool)</span>]</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">extern</span> <span class="built_in">bool</span> <span class="title">RegisterHotKey</span>(<span class="params">IntPtr hWnd, <span class="built_in">int</span> id, ModifierKeys fsModifiers, <span class="built_in">uint</span> vk</span>)</span>;</span><br></pre></td></tr></table></figure><p>Parameters:</p><ul><li><code>hWnd</code>: The handle of the window that will receive the hotkey notification, typically the handle of the main window.</li><li><code>id</code>: Identifier for the hotkey, used to distinguish different hotkeys.</li><li><code>fsModifiers</code>: Hotkey modifiers such as Ctrl, Alt, Shift, etc.</li><li><code>vk</code>: Virtual key code to be used with the hotkey, can be obtained through conversion from the <code>Key</code> enumeration.</li></ul><p>By default, the function returns a non-zero value if the hotkey is successfully registered and zero on failure. However, for ease of further processing, the <code>MarshalAs</code> attribute is used here to convert the return value into a boolean type.</p><h3 id="UnregisterHotKey-Function"><a href="#UnregisterHotKey-Function" class="headerlink" title="UnregisterHotKey Function"></a>UnregisterHotKey Function</h3><p>Purpose: Unregisters a previously registered global hotkey.</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">DllImport(<span class="string">&quot;user32.dll&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">extern</span> <span class="built_in">bool</span> <span class="title">UnregisterHotKey</span>(<span class="params">IntPtr hWnd, <span class="built_in">int</span> id</span>)</span>;</span><br></pre></td></tr></table></figure><p>Parameters:</p><ul><li><code>hWnd</code>: The window handle provided during the previous hotkey registration.</li><li><code>id</code>: The hotkey identifier provided during the previous registration.</li></ul><h3 id="Binding-Hotkey-Functionality"><a href="#Binding-Hotkey-Functionality" class="headerlink" title="Binding Hotkey Functionality"></a>Binding Hotkey Functionality</h3><p>Create a new method called <code>Regist</code> in <code>User32API.cs</code> to bind the hotkey functionality. When the program starts, the main window reads Key and ModifierKeys from user configuration, and then passes them along with a callback function to bind the hotkey command.</p><details class="note success"><summary><p>Main Window Code</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Override the window initialization method</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnSourceInitialized</span>(<span class="params">EventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.OnSourceInitialized(e);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Pass relevant parameters to the Regist method in User32API.cs</span></span><br><span class="line">    Regist(<span class="keyword">this</span>, hotKeyModifiers, hotKey, () =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (StopButton.IsEnabled) &#123; StopButton.RaiseEvent(<span class="keyword">new</span> RoutedEventArgs(System.Windows.Controls.Primitives.ButtonBase.ClickEvent)); &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123; StartButton.RaiseEvent(<span class="keyword">new</span> RoutedEventArgs(System.Windows.Controls.Primitives.ButtonBase.ClickEvent)); &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>In addition, I have defined a delegate type <code>HotKeyCallBackHanlder</code> here. It’s a pointer to a function and is used to define the action to be taken when a global hotkey is triggered.</p><p>A delegate is a reference type variable that holds a reference to a method with a particular signature. It allows us to define the signature of a method and then use it as a parameter for methods or assign it to other method variables for dynamic method invocation at runtime.</p><details class="note success"><summary><p>Hotkey Registration Code and Explanation</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">HotKeyCallBackHanlder</span>()</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> HotKeyCallBackHanlder hotKeyCallBackHanlder = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Regist</span>(<span class="params">Window window, ModifierKeys fsModifiers, Key key, HotKeyCallBackHanlder callBack</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Get the window&#x27;s handle</span></span><br><span class="line">    <span class="keyword">var</span> hwnd = <span class="keyword">new</span> WindowInteropHelper(window).Handle;</span><br><span class="line">    <span class="comment">// Create an HwndSource object using the window&#x27;s handle</span></span><br><span class="line">    <span class="keyword">var</span> _hwndSource = HwndSource.FromHwnd(hwnd);</span><br><span class="line">    <span class="comment">// Add the message processing delegate WndProc to the window&#x27;s message processing chain,</span></span><br><span class="line">    <span class="comment">// so that when the window receives a message, it&#x27;s first passed to the WndProc method for handling</span></span><br><span class="line">    _hwndSource.AddHook(WndProc);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Convert the incoming Key to a virtual key code (vk)</span></span><br><span class="line">    <span class="keyword">var</span> vk = KeyInterop.VirtualKeyFromKey(key);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Display an error message box if registration fails</span></span><br><span class="line">    <span class="keyword">if</span> (!RegisterHotKey(hwnd, HOTKEY_ID, fsModifiers, (<span class="built_in">uint</span>)vk))</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;Failed to register global hotkey!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Assign the callback function to the hotKeyCallBackHanlder variable.</span></span><br><span class="line">    <span class="comment">// This callback function is the &#x27;callBack&#x27; parameter passed in from the main window during registration</span></span><br><span class="line">    hotKeyCallBackHanlder = callBack;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="Handle-Hotkey-Messages"><a href="#Handle-Hotkey-Messages" class="headerlink" title="Handle Hotkey Messages"></a>Handle Hotkey Messages</h3><p>In Windows, <code>WndProc</code> is a function used to handle window messages. When a registered hotkey is triggered, the system sends a window message to the specified window handle, and we can process this message in the <code>WndProc</code> function.</p><details class="note success"><summary><p>Handling Window Messages in WndProc</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> IntPtr <span class="title">WndProc</span>(<span class="params">IntPtr hwnd, <span class="built_in">int</span> msg, IntPtr wParam, IntPtr lParam, <span class="keyword">ref</span> <span class="built_in">bool</span> handled</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// When receiving the WM_HOTKEY message and the hotkey ID matches, the hotKeyCallBackHanlder() is called,</span></span><br><span class="line">    <span class="comment">// which executes the pre-defined callback function.</span></span><br><span class="line">    <span class="keyword">if</span> (msg == WM_HOTKEY &amp;&amp; wParam.ToInt32() == HOTKEY_ID)</span><br><span class="line">    &#123;</span><br><span class="line">        hotKeyCallBackHanlder();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> IntPtr.Zero;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h2 id="Change-Hotkeys"><a href="#Change-Hotkeys" class="headerlink" title="Change Hotkeys"></a>Change Hotkeys</h2><p>Create a new method called <code>ModifyGlobalHotKey</code> in <code>User32API.cs</code>. When the user enters a new hotkey in the settings window and clicks the “OK” button, the program will update the variable storing the hotkey value and pass the updated hotkey value to <code>User32API.cs</code>.</p><p><code>ModifyGlobalHotKey</code> will first unregister the previous hotkey and then attempt to register the new hotkey. If the registration fails, an error message box will be displayed.</p><details class="note success"><summary><p>Modifying Hotkeys with ModifyGlobalHotKey</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ModifyGlobalHotKey</span>(<span class="params">WindowInteropHelper windowInteropHelper, Key key, ModifierKeys modifiers</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Unregister the previous hotkey</span></span><br><span class="line">    UnregisterHotKey(windowInteropHelper.Handle, HOTKEY_ID);</span><br><span class="line">    <span class="comment">// Attempt to register the new hotkey</span></span><br><span class="line">    <span class="keyword">if</span> (!RegisterHotKey(windowInteropHelper.Handle, HOTKEY_ID, modifiers, (<span class="built_in">uint</span>)KeyInterop.VirtualKeyFromKey(key)))</span><br><span class="line">        MessageBox.Show(<span class="string">&quot;Failed to register global hotkey!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h2 id="Read-in-and-Save-Hotkeys"><a href="#Read-in-and-Save-Hotkeys" class="headerlink" title="Read-in and Save Hotkeys"></a>Read-in and Save Hotkeys</h2><p>Since both the <code>Key</code> and <code>ModifierKeys</code> that make up a hotkey are enumeration types, and <code>./Properties/Settings.settings</code> does not support storing enumeration types, we need to use <code>ToString()</code> to convert them into string types before saving.</p><details class="note success"><summary><p>Save Hotkeys Code</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Key hotKey;</span><br><span class="line"><span class="keyword">private</span> ModifierKeys hotKeyModifiers;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">CloseButton_Click</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Properties.Settings.Default.HotKey = hotKey.ToString();</span><br><span class="line">    Properties.Settings.Default.Modifiers = hotKeyModifiers.ToString();</span><br><span class="line">    Properties.Settings.Default.Save();</span><br><span class="line">    <span class="comment">//Close();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>During program startup, use <code>Enum.Parse()</code> to convert the stored strings back into enumeration types. Make sure to place this code in the window’s initialization code; if placed in the window’s load code, this segment might not get executed, which is confusing.</p><details class="note success"><summary><p>Read-in Hotkeys Code</p></summary><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Key hotKey;</span><br><span class="line"><span class="keyword">private</span> ModifierKeys hotKeyModifiers;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">MainWindow</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    InitializeComponent();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Read-in and convert hotkeys</span></span><br><span class="line">    hotKey = (Key)Enum.Parse(<span class="keyword">typeof</span>(Key), Properties.Settings.Default.HotKey);</span><br><span class="line">    hotKeyModifiers = (ModifierKeys)Enum.Parse(<span class="keyword">typeof</span>(ModifierKeys), Properties.Settings.Default.Modifiers);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h1 id="Localization"><a href="#Localization" class="headerlink" title="Localization"></a>Localization</h1><p>There are multiple methods for localizing WPF applications, such as using resource dictionaries, NuGet packages, and <code>.resx</code> resource files. I’m using the relatively convenient <code>.resx</code> resource files.</p><h2 id="Create-Resource-Files"><a href="#Create-Resource-Files" class="headerlink" title="Create Resource Files"></a>Create Resource Files</h2><ol><li>Open <code>./Properties/Resources.resx</code> in the Visual Studio Solution Explorer. The structure here is similar to a <code>Dictionary&lt;string, string&gt;</code>, where the name serves as the <code>Key</code> and the value is the <code>Value</code>.</li><li>Fill in default language resource key-value pairs.</li><li>Change the <code>Access Modifier</code> from <code>Internal</code> to <code>Public</code>.</li><li>Add a new resource file and name it as <code>Resources.[LCID].resx</code>, where <code>[LCID]</code> is the Windows Language Code Identifier. For example, the resource file for Simplified Chinese should be named <code>Resources.zh-CN.resx</code>. For a complete list of language codes, refer to <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c?redirectedfrom=MSDN">MS-LCID</a>.<div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://s2.loli.net/2023/08/18/qV8WgfKp1siz3he.png" alt="bpc_resx1.png"></div><div class="group-picture-column"><img data-src="https://s2.loli.net/2023/08/18/Ym1iJnjEg9TUR8x.png" alt="bpc_resx2.png"></div></div></div></li><li>Copy the contents from <code>Resources.resx</code> to the newly created resource file and modify the values according to the language.<br><img data-src="https://s2.loli.net/2023/08/18/xZBtpjzkPunINsb.png" alt="bpc_resx3.png"></li></ol><h2 id="Usage-1"><a href="#Usage-1" class="headerlink" title="Usage"></a>Usage</h2><h3 id="XAML"><a href="#XAML" class="headerlink" title="XAML"></a>XAML</h3><p>In your XAML files, add a new namespace reference, replacing <code>PackageName</code> with your project name:</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xmlns:lang=<span class="string">&quot;clr-namespace:[PackageName].Properties&quot;</span></span><br></pre></td></tr></table></figure><p>Use <code>x:Static</code> to reference resources in your text content. In the following example, <code>KeyName</code> is the key value from the language resource file:</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Text=<span class="string">&quot;&#123;x:Static lang:Resources.KeyName&#125;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><p>In your code, you can directly reference resources:</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> example = Properties.Resources.KeyName;</span><br></pre></td></tr></table></figure><h2 id="Runtime"><a href="#Runtime" class="headerlink" title="Runtime"></a>Runtime</h2><p>The functionality I implemented is that the program automatically switches to the corresponding language based on the system’s language identifier when it starts. Currently, only Simplified Chinese and English are supported. You can use <code>CultureInfo.CurrentUICulture.Name</code> to get the system’s language identifier. To achieve this, you need to modify <code>App.xaml.cs</code>. Here’s the complete code:</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnStartup</span>(<span class="params">StartupEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.OnStartup(e);</span><br><span class="line">    <span class="keyword">if</span> (CultureInfo.CurrentUICulture.Name == <span class="string">&quot;zh-CN&quot;</span>) <span class="comment">// If the current system language is zh-CN (Simplified Chinese)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Thread.CurrentThread.CurrentUICulture = <span class="keyword">new</span> CultureInfo(<span class="string">&quot;zh-CN&quot;</span>); <span class="comment">// Set the program language to Simplified Chinese using ./Properties/Resources.zh-CN.resx</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Otherwise, use the default language set in ./Properties/Resources.resx</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Packaging-the-Program"><a href="#Packaging-the-Program" class="headerlink" title="Packaging the Program"></a>Packaging the Program</h1><p>The solution folder generated by Visual Studio contains many files, including resource files such as images and audio, as well as the necessary DLL runtime libraries. These files are essential for the program to run and are often referred to as dependencies. If you try to copy only the executable file (exe) to another directory, it won’t run because it lacks these dependencies. This poses the problem that users need to download the entire folder containing dependencies to use the software, which is inconvenient. Therefore, the challenge here is to package all the required files into a single executable (exe) so that users can use it directly. The solution involves installing two NuGet packages: <code>Costura.Fody</code> and <code>Resource.Embedder</code>.</p><h2 id="Costura-Fody"><a href="#Costura-Fody" class="headerlink" title="Costura.Fody"></a>Costura.Fody</h2><p><a target="_blank" rel="noopener" href="https://github.com/Fody/Costura">Costura.Fody</a> is an open-source add-in for Fody. Its main function is to embed dependencies from assemblies into the main assembly, reducing the need for external dependencies during deployment and distribution. It achieves this by modifying the Intermediate Language (IL) code during compilation, so you don’t have to worry about missing external dependencies at runtime.</p><h3 id="Installation-and-Usage"><a href="#Installation-and-Usage" class="headerlink" title="Installation and Usage"></a>Installation and Usage</h3><p>Search for Costura.Fody in the NuGet Manager in Visual Studio and install it. Since it’s an add-in for Fody, installing it will also install Fody itself along with many dependencies, around 40 of them.</p><p>After installation, create a new file named <code>FodyWeavers.xml</code> and add it to the root directory of your solution explorer. Then, paste the following content into the file and save it:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Weavers</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">&quot;FodyWeavers.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Costura</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Weavers</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Now, rebuild the solution in Visual Studio. You’ll notice that the size of the generated executable (exe) file has increased significantly. When you copy this executable to another directory, it can be used normally without needing to copy additional files.</p><h3 id="New-Issue"><a href="#New-Issue" class="headerlink" title="New Issue"></a>New Issue</h3><p>While adding localization support to the program, I encountered a new problem. The newly created <code>.resx</code> language files were not being correctly added to the executable (exe) by Costura.Fody, resulting in the program always displaying in English during runtime. If I was debugging within Visual Studio, the program could display in the newly added language, but when I copied the exe file separately, it reverted to the default language.</p><p>At this point, the file structure in the <code>./bin/Debug</code> directory looked like this:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">./Debug</span><br><span class="line">    │  </span><br><span class="line">    ├──ProjectName.exe</span><br><span class="line">    │</span><br><span class="line">    └──./zh-CN</span><br><span class="line">            │</span><br><span class="line">            └──xxxxx.dll</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Based on my research, I deduced that this issue might be related to the fact that the localized resources are part of <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/dotnet/core/extensions/create-satellite-assemblies">Satellite Assemblies</a>. Resources from satellite assemblies are available in specific cultures, and these resources are loaded only when the user selects the corresponding culture settings. However, during the execution of Costura.Fody, the new language files weren’t selected and loaded. Consequently, only the default language files were embedded, and the new language files were loaded into the solution directory after the packaging was completed.</p><div class="note primary"><p>The related issue has already been discussed on GitHub: <a target="_blank" rel="noopener" href="https://github.com/Fody/Costura/issues/61">Costura doesn’t embed resource satellite assemblies</a>, and a solution has been provided: Install Resource.Embedder and use it in conjunction with Costura.Fody.</p></div><details class="note success"><summary><p>Satellite Assemblies</p></summary><h3 id="Satellite-Assemblies"><a href="#Satellite-Assemblies" class="headerlink" title="Satellite Assemblies"></a>Satellite Assemblies</h3><p>In WPF, primary assemblies and satellite assemblies are two different concepts of assemblies that have some differences in how they organize, deploy, and access resources in an application.</p><h4 id="Primary-Assembly"><a href="#Primary-Assembly" class="headerlink" title="Primary Assembly"></a>Primary Assembly</h4><p>The primary assembly is the core assembly of an application. It usually contains the application’s startup code, main logic, and main window. The primary assembly can include various resources such as XAML files, images, styles, templates, etc. These resources can be accessed and used throughout the application’s lifecycle. The primary assembly typically has the following characteristics:</p><ul><li>Entry Point: The primary assembly contains the entry point of the application, which is the code executed when the application starts.</li><li>Global Resources: Resources in the primary assembly can be accessed throughout the application without specific references.</li><li>In-Memory: Resources in the primary assembly remain in memory during the application’s runtime, unless explicitly released.</li></ul><h4 id="Satellite-Assembly"><a href="#Satellite-Assembly" class="headerlink" title="Satellite Assembly"></a>Satellite Assembly</h4><p>Satellite assemblies are auxiliary assemblies used for localization and resource management. They contain translated or localized versions of an application’s localized text, images, and other resources. Satellite assemblies enable the application to choose the correct resources based on the user’s language and region. Satellite assemblies generally have the following characteristics:</p><ul><li>Localized Resources: Satellite assemblies include localized or different language versions of resources to accommodate various languages and regions.</li><li>Lazy Loading: Satellite assemblies are loaded into memory only when needed to reduce memory consumption.</li><li>Naming Convention: Satellite assemblies are usually named based on the language and region, such as AssemblyName.resources.dll.</li><li>Region-Specific: Resources in satellite assemblies are available in specific regions, and these resources are loaded only when the user selects the corresponding regional settings.</li></ul><h4 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h4><p>The primary assembly contains the main logic and resources of the application, while satellite assemblies are used for localization and resource management. The primary assembly includes the core code and global resources, while satellite assemblies contain localized resources specific to languages and regions. By separating resources into primary and satellite assemblies, WPF applications can achieve multilingual support, resource management, and better memory utilization.</p></details><h3 id="Important-Note"><a href="#Important-Note" class="headerlink" title="Important Note"></a>Important Note</h3><p>After rebuilding the solution using Costura.Fody, you might encounter errors in the Visual Studio XAML file preview. This is because Costura.Fody embeds all resources into the exe file, causing the Visual Studio design environment to be unable to find resources based on their original relative paths, resulting in preview errors. To resolve this, you can temporarily comment out the <code>&lt;Costura /&gt;</code> tag in the <code>FodyWeavers.xml</code> file when designing and previewing.</p><h2 id="Resource-Embedder"><a href="#Resource-Embedder" class="headerlink" title="Resource.Embedder"></a>Resource.Embedder</h2><p><a target="_blank" rel="noopener" href="https://www.nuget.org/packages/Resource.Embedder/">Resource.Embedder</a> is a tool for embedding resource files into .NET assemblies. Its working principle involves creating a virtual file system, embedding resource files into it, and then having Costura.Fody embed this virtual file system into the main assembly, achieving the embedding of satellite assemblies.</p><p>The installation process is similar to the previous package. Search for it in the NuGet Manager in Visual Studio and install it. After installation, there is no need to perform any additional configurations. Rebuild the solution in Visual Studio, and now the exe file should display in the new language and be runnable as a standalone application.</p><h1 id="NET-Framework"><a href="#NET-Framework" class="headerlink" title=".NET Framework"></a>.NET Framework</h1><p>The <code>.NET Framework</code> is a development framework developed by Microsoft for building and running applications on the Windows operating system. The program targets the <code>.NET Framework 4.8</code> as its framework version.</p><p>Starting from the <code>Windows 10 May 2019 Update (version 1903)</code>, <code>.NET Framework 4.8</code> began to be pre-installed on Windows systems. Therefore, if you are running this program on an earlier version of Windows, you need to install <code>.NET Framework 4.8</code> separately.</p><h2 id="Relationship-Between-NET-Framework-Versions-and-Windows-Versions"><a href="#Relationship-Between-NET-Framework-Versions-and-Windows-Versions" class="headerlink" title="Relationship Between .NET Framework Versions and Windows Versions"></a>Relationship Between .NET Framework Versions and Windows Versions</h2><ul><li>.NET Framework 1.0 and 1.1: Released in compatibility with Windows XP.</li><li>.NET Framework 2.0: Compatible with Windows XP, Windows Server 2003, and Windows Vista.</li><li>.NET Framework 3.0 and 3.5: Built into Windows Vista and Windows Server 2008, and can also be installed on Windows XP and Windows Server 2003 through updates.</li><li>.NET Framework 4.0: Compatible with Windows XP, Windows Server 2003, Windows Vista, Windows 7, Windows Server 2008, and Windows Server 2008 R2.</li><li>.NET Framework 4.5 to 4.8: Compatible with Windows 7, Windows 8, Windows 8.1, Windows 10, and corresponding Windows Server versions.</li></ul><h2 id="NET-Core-vs-NET-Framework"><a href="#NET-Core-vs-NET-Framework" class="headerlink" title=".NET Core vs. .NET Framework"></a>.NET Core vs. .NET Framework</h2><p>.NET Core and .NET Framework are both cross-platform development frameworks developed by Microsoft. Here’s a brief comparison between .NET Core and .NET Framework:</p><ol><li>Cross-Platform Support<ul><li>.NET Core: Designed to be cross-platform, it can run on Windows, Linux, and macOS.</li><li>.NET Framework: Primarily targeted at the Windows platform and cannot run directly on other operating systems.</li></ul></li><li>Open Source Nature<ul><li>.NET Core: Completely open source, with its source code hosted on GitHub.</li><li>.NET Framework: While there are some open-source components and tools, the framework as a whole is not fully open source.</li></ul></li><li>Dependency and Deployment<ul><li>.NET Core: Manages dependencies using NuGet, and applications can be self-contained in terms of required runtime libraries.</li><li>.NET Framework: Applications rely on the Global Assembly Cache (GAC), and developers need to ensure the required .NET Framework version is present on the target machine.</li></ul></li><li>Versioning and Updates<ul><li>.NET Core: Has shorter release cycles with frequent updates, introducing new features and improvements with each update.</li><li>.NET Framework: Has longer release cycles with relatively slower updates, typically in the form of service packs or larger releases.</li></ul></li><li>API Support<ul><li>.NET Core: Offers a more modern and streamlined set of APIs, some Windows-specific features might not be supported in .NET Core.</li><li>.NET Framework: Provides rich support for Windows APIs, enabling access to a wide range of Windows features.</li></ul></li><li>WPF and WinForms<ul><li>.NET Core: Currently lacks native support for WPF and WinForms application development, but support can be achieved through certain tools and libraries.</li><li>.NET Framework: Offers full support for WPF and WinForms.</li></ul></li><li>Performance<ul><li>.NET Core: Generally offers better performance compared to .NET Framework due to its lightweight design and cross-platform nature.</li><li>.NET Framework: Optimized for the Windows platform but might be relatively weaker in terms of cross-platform and performance aspects.</li></ul></li></ol><p><strong>Venting</strong>: Why is writing documentation more exhausting than designing the UI…</p></div><footer class="post-footer"><div><div style="text-align:center;color:#ccc;font-size:14px">---------- This article ends here. <i class="fa fa-dice-d20"></i> Thank you for reading! ----------</div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>Post author: </strong>Sirius</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://siriusq.top/en/bongo-paw-blicker.html" title="Bongo Paw Clicker Development Summary">https://siriusq.top/en/bongo-paw-blicker.html</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="post-tags"><a href="/en/tags/WPF/" rel="tag"><i class="fa fa-tag"></i> WPF</a> <a href="/en/tags/Bongo-Paw-Clicker/" rel="tag"><i class="fa fa-tag"></i> Bongo Paw Clicker</a> <a href="/en/tags/Log/" rel="tag"><i class="fa fa-tag"></i> Log</a> <a href="/en/tags/C/" rel="tag"><i class="fa fa-tag"></i> C#</a></div><div class="post-nav"><div class="post-nav-item"><a href="/en/turn-on-igpu.html" rel="prev" title="Enabling Integrated Graphics with Discrete Graphics Installed"><i class="fa fa-angle-left"></i> Enabling Integrated Graphics with Discrete Graphics Installed</a></div><div class="post-nav-item"><a href="/en/stellaris-mod.html" rel="next" title="Stellaris Mod Creation and Upload Log">Stellaris Mod Creation and Upload Log <i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Sirius</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="Word count total">115k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="Reading time total">6:57</span></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span id="busuanzi_value_site_pv"></span></span></span></div><div><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("03/31/2019 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="This site has been running safely for "+dnum+" days ",document.getElementById("times").innerHTML=hnum+" hrs "+mnum+" mins "+snum+" secs"}setInterval("createtime()",250)</script></div></div></footer><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.umd.js" integrity="sha256-oyhjPiYRWGXaAt+ny/mTMWOnN1GBoZDUQnzzgC7FRI4=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/next-boot.js"></script><script src="/en/js/bookmark.js"></script><script src="/en/js/pjax.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script src="/en/js/third-party/fancybox.js"></script><script src="/en/js/third-party/pace.js"></script><script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script><script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://siriusq.top/en/bongo-paw-blicker.html"}</script><script src="/en/js/third-party/quicklink.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous"><script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"Siriusq","repo":"gitalk-commnet","client_id":"4217cae26df745a55acd","client_secret":"b7f2cc0c82be38a4e0f294f12f761bc4799669cd","admin_user":"Siriusq","distraction_free_mode":false,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"b6503e53e5ca86c33c6211512fd60289"}</script><script src="/en/js/third-party/comments/gitalk.js"></script><script type="text/javascript" src="/en/js/crash_cheat.js"></script><script async src="/en/js/fireworks.js"></script></body></html>