<!DOCTYPE html><html lang="en"><head><link href="https://unpkg.com/@splidejs/splide@4.1.4/dist/css/splide.min.css" rel="stylesheet"><style type="text/css">.splide{border:2px solid var(--carousel-border-color);box-shadow:0 4px 8px var(--carousel-shadow-color);border-radius:var(--carousel-border-radius)}.splide__slide img{width:100%;height:100%;object-fit:contain}.carousel-container{visibility:inherit;margin-top:20px;margin-bottom:20px}.carousel-caption{min-height:2em;line-height:2em;text-align:center;font-size:.9em;font-style:italic;padding:6px;margin-left:auto;margin-right:auto}.splide__arrow{background:0 0;align-items:center;border:0;cursor:pointer;display:flex;height:5em;justify-content:center;position:absolute;top:50%;transform:translateY(-50%);width:5em;z-index:10}.splide__arrow:disabled{opacity:0}.splide__arrow--prev{left:0}.splide__arrow--next{right:0}.splide__arrow svg{fill:var(--carousel-arrow-color);height:2.5em;transition:fill .2s linear;width:2.5em}.splide__arrow:hover:not(:disabled) svg{fill:var(--carousel-arrow-hover-color)}.splide__arrow:focus-visible{outline:transparent;outline-offset:0}.splide.is-focus-in .splide__arrow:focus{outline:transparent;outline-offset:0}.splide__pagination__page:focus-visible{outline:transparent;outline-offset:0}.splide.is-focus-in .splide__pagination__page:focus{outline:transparent;outline-offset:0}.splide__pagination{bottom:1em;left:0;padding:0 1em;position:absolute;right:0;z-index:1}.splide__pagination__page{background:var(--carousel-pagination-color);border:0;border-radius:2.5px;display:inline-block;height:5px;margin:3px;width:20px;transition:background-color .2s linear}.splide__pagination__page.is-active{background:var(--carousel-pagination-active-color)}.splide__pagination__page:hover{background:var(--carousel-pagination-hover-color);cursor:pointer;opacity:.9}.splide__pagination__page::before{content:'';position:absolute;top:-18px;bottom:-18px;left:-4px;right:-4px}.splide__pagination__page.is-active::before{content:'';position:absolute;top:-12px;bottom:-12px;left:-1px;right:-1px}.zoomable{object-fit:contain}.zooming{max-width:90vw!important;max-height:90vh!important;object-fit:contain!important}</style><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><link rel="manifest" href="/en/images/site.webmanifest"><meta name="msvalidate.01" content="BE3DB9F22A0915AF3452024048D66934"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300italic,400,400italic,700,700italic%7CNoto+Serif:300,300italic,400,400italic,700,700italic%7CFira+Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-flash.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"siriusq.top","root":"/en/","images":"/en/images","scheme":"Gemini","darkmode":"auto","version":"8.20.0","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":320,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":false,"lazyload":true,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><meta name="description" content="Grasscutter is an experimental server written in Java, designed to simulate the server-side of a certain Anime Game. This article documents the process of configuring the server, including the install"><meta property="og:type" content="article"><meta property="og:title" content="Grasscutter Windows Local Server Configuration Guide"><meta property="og:url" content="https://siriusq.top/en/grasscutter.html"><meta property="og:site_name" content="Sirius"><meta property="og:description" content="Grasscutter is an experimental server written in Java, designed to simulate the server-side of a certain Anime Game. This article documents the process of configuring the server, including the install"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://s2.loli.net/2023/11/11/G2KwYIs4yVaM6CT.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/FLuEvQB2oUqw13l.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/rRhxCA4BYDVu25U.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/Y4mrh23sL71CUJx.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/OgrBZdvYXPmsNfl.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/jleJCaPN1iKBFDp.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/FRVI5289awtUPKT.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/Cn7RpUYOSiuyWL8.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/jIzsNPqfhEFkKo5.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/TPRCVJ4I1OqikyX.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/7kPdbWUavsKeoDY.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/08/E3KiqTQy9kJWZb2.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/08/sOvpqaElQIBf47F.webp"><meta property="og:image" content="https://s2.loli.net/2023/11/11/uoCZmLU3EWQ9aGf.webp"><meta property="article:published_time" content="2023-11-07T13:17:07.000Z"><meta property="article:modified_time" content="2024-09-13T16:11:05.000Z"><meta property="article:author" content="Sirius"><meta property="article:tag" content="Grasscutter"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2023/11/11/G2KwYIs4yVaM6CT.webp"><link rel="canonical" href="https://siriusq.top/en/grasscutter.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://siriusq.top/en/grasscutter.html","path":"grasscutter.html","title":"Grasscutter Windows Local Server Configuration Guide"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Grasscutter Windows Local Server Configuration Guide | Sirius</title><script src="/en/live2d-widget/autoload.js"></script><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Sirius" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Sirius</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">May the Force be with you</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/en/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/en/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">110</span></a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">11</span></a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">73</span></a></li><li class="menu-item menu-item-tools"><a href="/en/tools/" rel="section"><i class="fa fa-screwdriver-wrench fa-fw"></i>Tools</a></li><li class="menu-item menu-item-switch-to-chinese"><a href="https://siriusq.top/" rel="section"><i class="fa fa-language fa-fw"></i>Switch to Chinese</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Environment-Setup"><span class="nav-number">1.</span> <span class="nav-text">Environment Setup</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Client-Download"><span class="nav-number">2.</span> <span class="nav-text">Client Download</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Server-Setup"><span class="nav-number">3.</span> <span class="nav-text">Server Setup</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Installation-of-Cultivation"><span class="nav-number">3.1.</span> <span class="nav-text">Installation of Cultivation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Download-Grasscutter"><span class="nav-number">3.2.</span> <span class="nav-text">Download Grasscutter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Configure-Cultivation"><span class="nav-number">3.3.</span> <span class="nav-text">Configure Cultivation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#XX-Launch"><span class="nav-number">4.</span> <span class="nav-text">XX, Launch!</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Commands"><span class="nav-number">5.</span> <span class="nav-text">Commands</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tools"><span class="nav-number">6.</span> <span class="nav-text">Tools</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Plugins"><span class="nav-number">7.</span> <span class="nav-text">Plugins</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#gc-opencommand-plugin"><span class="nav-number">7.1.</span> <span class="nav-text">gc-opencommand-plugin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Grasscutter-Rollback"><span class="nav-number">7.2.</span> <span class="nav-text">Grasscutter-Rollback</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Banner-Replacement"><span class="nav-number">8.</span> <span class="nav-text">Banner Replacement</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Edit-Shop-Items"><span class="nav-number">9.</span> <span class="nav-text">Edit Shop Items</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Character-Model-Replacement"><span class="nav-number">10.</span> <span class="nav-text">Character Model Replacement</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Sirius" src="https://s2.loli.net/2022/05/23/kxtRKT4u71HXlUY.gif"><p class="site-author-name" itemprop="name">Sirius</p><div class="site-description" itemprop="description">Thread_sleep(1); //be nice to the CPU</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/en/archives/"><span class="site-state-item-count">73</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/en/categories/"><span class="site-state-item-count">11</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/en/tags/"><span class="site-state-item-count">110</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Siriusq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Siriusq" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="/en/atom.xml" title="RSS Feed → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i>RSS Feed</a> </span><span class="links-of-author-item"><a href="mailto:siriusq.top@outlook.com" title="E-Mail → mailto:siriusq.top@outlook.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://leetcode.com/Siriusq/" title="LeetCode → https:&#x2F;&#x2F;leetcode.com&#x2F;Siriusq&#x2F;" rel="noopener me" target="_blank"><i class="fa fa-code fa-fw"></i>LeetCode</a></span></div><script src="/en/js/switch_limited.js"></script></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://siriusq.top/en/grasscutter.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://s2.loli.net/2022/05/23/kxtRKT4u71HXlUY.gif"><meta itemprop="name" content="Sirius"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sirius"><meta itemprop="description" content="Thread_sleep(1); //be nice to the CPU"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Grasscutter Windows Local Server Configuration Guide | Sirius"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Grasscutter Windows Local Server Configuration Guide</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2023-11-07 21:17:07" itemprop="dateCreated datePublished" datetime="2023-11-07T21:17:07+08:00">2023-11-07</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-09-14 00:11:05" itemprop="dateModified" datetime="2024-09-14T00:11:05+08:00">2024-09-14</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Windows/" itemprop="url" rel="index"><span itemprop="name">Windows</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="Word count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">Word count in article: </span><span>1.8k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span>7 mins.</span></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote class="blockquote-center">Grasscutter is an experimental server written in Java, designed to simulate the server-side of a certain Anime Game. This article documents the process of configuring the server, including the installation of Grasscutter and Cultivation, the usage of relevant commands, methods for utilizing practical plugins and tools, configuration of gacha pools and shops, as well as the replacement of character models.</blockquote><span id="more"></span><div class="note warning"><p>Note: This article is based on the Windows 11 system, where the client and server run on the same PC.</p></div><div class="note default"><p>Tip: Please replace <code>[Username]</code> in the provided file paths with your own Windows username.</p></div><h1 id="Environment-Setup"><a href="#Environment-Setup" class="headerlink" title="Environment Setup"></a>Environment Setup</h1><p>Grasscutter relies on <code>Java</code> and <code>MongoDB</code> for its operation. It is recommended to install JDK17, and the latest version of MongoDB. Below are the download links:</p><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/download.webp"></object><p>Java</p><p>Download Java SE Development Kit 17</p><a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html"></a></div><div class="link-grid-container"><object class="link-grid-image" data="/images/link/download.webp"></object><p>MongoDB Community</p><p>Download MongoDB Community Edition</p><a target="_blank" rel="noopener" href="https://www.mongodb.com/try/download/community"></a></div></div><div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-413d4362t"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="Download JDK17.webp"><img data-src="https://s2.loli.net/2023/11/11/G2KwYIs4yVaM6CT.webp" alt="Download JDK17.webp" class="zoomable"></li><li class="splide__slide" data-caption="Download MongoDB.webp"><img data-src="https://s2.loli.net/2023/11/11/FLuEvQB2oUqw13l.webp" alt="Download MongoDB.webp" class="zoomable"></li></ul></div></div><div id="carousel-caption-413d4362t" class="carousel-caption"></div></div><p><strong>Java Installation:</strong></p><ul><li>Download the Java installation package, selecting either <code>Windows x64 Installer</code> or <code>Windows x64 MSI Installer</code>.</li><li>During installation, proceed with the default options.</li></ul><p><strong>MongoDB Installation:</strong></p><ol><li>Download MongoDB, opting for the community edition in <code>msi</code> format.</li><li>Choose <code>Complete</code> installation during setup.</li><li>In <code>Service Configuration</code>, you can modify file paths (the last two options), keeping the rest as default.</li><li>MongoDB Compass is the graphical user interface for MongoDB, which is optional.</li></ol><div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-03zcrp6ab"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="Choose Complete.webp"><img data-src="https://s2.loli.net/2023/11/11/rRhxCA4BYDVu25U.webp" alt="Choose Complete.webp" class="zoomable"></li><li class="splide__slide" data-caption="Service Configuration.webp"><img data-src="https://s2.loli.net/2023/11/11/Y4mrh23sL71CUJx.webp" alt="Service Configuration.webp" class="zoomable"></li><li class="splide__slide" data-caption="MongoDB Compass.webp"><img data-src="https://s2.loli.net/2023/11/11/OgrBZdvYXPmsNfl.webp" alt="MongoDB Compass.webp" class="zoomable"></li></ul></div></div><div id="carousel-caption-03zcrp6ab" class="carousel-caption"></div></div><h1 id="Client-Download"><a href="#Client-Download" class="headerlink" title="Client Download"></a>Client Download</h1><p>The client download links can be obtained from <code>GI-Download-Library</code>.</p><ul><li>The download link for the main files is available in <code>GI-Download-Library/GenshinImpact/Client/[Version].md</code>. After downloading, unzip the files.</li><li>The download link for voice files can be found in <code>GI-Download-Library/GenshinImpact/Audio/[Version].md</code>. After extracting, copy the folder to the main files’ directory.</li></ul><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/github.webp"></object><p>GI-Download-Library</p><p>Download Main Files and Voice Files</p><a target="_blank" rel="noopener" href="https://github.com/MAnggiarMustofa/GI-Download-Library"></a></div></div><h1 id="Server-Setup"><a href="#Server-Setup" class="headerlink" title="Server Setup"></a>Server Setup</h1><h2 id="Installation-of-Cultivation"><a href="#Installation-of-Cultivation" class="headerlink" title="Installation of Cultivation"></a>Installation of Cultivation</h2><p>Cultivation is a cross-platform launcher developed by the Grasscutter team, capable of running on Windows, macOS, and Linux. It comes with a built-in proxy function, greatly simplifying the Grasscutter installation process; just a few clicks are needed to run it.</p><p>Download the file with the <code>msi</code> extension from the link below, for example, <code>Cultivation_1.2.0_x64_en-US.msi</code>.</p><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/github.webp"></object><p>Cultivation</p><p>Cultivation Release Page</p><a target="_blank" rel="noopener" href="https://github.com/Grasscutters/Cultivation/releases"></a></div></div><p>After installation, restart your computer, and then run Cultivation as an administrator.</p><h2 id="Download-Grasscutter"><a href="#Download-Grasscutter" class="headerlink" title="Download Grasscutter"></a>Download Grasscutter</h2><p>Click on the <code>Download</code> icon in the top right corner of Cultivation,</p><ul><li>Depending on your preferences, download either the <code>All-in-One</code> file. Both downloaded files are pre-built, eliminating the need for manual compilation.<ul><li><code>Grasscutter All-in-One</code> doesn’t include quests, but some scenes require unlocking through commands, such as the wind barrier in the Stormterror’s Lair.</li><li><code>Questing All-in-One</code> includes quests, but be aware that there might be some bugs, occasionally requiring manual input of commands to proceed with tasks. For more details, refer to: <a target="_blank" rel="noopener" href="https://docs.google.com/spreadsheets/u/0/d/1uao72LmJ5ZkPswOaceEcgtSMJRKlaoO2WBuf_8uStiQ/htmlview?pli=1#">Common Quest Bugs and Command Handling</a>.</li></ul></li><li>Download <code>Grasscutter Resources</code>.</li></ul><div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-jjiage5jc"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="Download Grasscutter.webp"><img data-src="https://s2.loli.net/2023/11/11/jleJCaPN1iKBFDp.webp" alt="Download Grasscutter.webp" class="zoomable"></li></ul></div></div><div id="carousel-caption-jjiage5jc" class="carousel-caption"></div></div><p>If you need resources from a specific version, you can switch to the corresponding branch in the repository below. After downloading, copy the files to the <code>C:\Users\[Username]\AppData\Roaming\cultivation\grasscutter\resources</code> folder.</p><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/download.webp"></object><p>GC Resources</p><p>GitLab Repository for Resource Files</p><a target="_blank" rel="noopener" href="https://gitlab.com/YuukiPS/GC-Resources"></a></div></div><h2 id="Configure-Cultivation"><a href="#Configure-Cultivation" class="headerlink" title="Configure Cultivation"></a>Configure Cultivation</h2><p>Upon the first launch, a popup window will prompt you to install the CA certificate. Click <code>Yes</code> to agree to the installation. After installing the certificate, Cultivation’s built-in mitmproxy will be able to proxy the communication between the client and the game server through a Man-in-the-Middle (MITM) attack to the local server.</p><div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-kx0mj3tjt"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="安装证书.webp"><img data-src="https://s2.loli.net/2023/11/11/FRVI5289awtUPKT.webp" alt="安装证书.webp" class="zoomable"></li></ul></div></div><div id="carousel-caption-kx0mj3tjt" class="carousel-caption"></div></div><p>Click on the small gear icon in the top right corner of Cultivation to open the settings page,</p><ul><li>At the bottom is the language settings section, supporting multiple languages.</li><li>For the <code>game install path</code>, select the <code>GenshinImpact.exe</code> file in the root directory of the client folder.</li><li>Confirm that the following four options are checked:<ul><li><code>Automatically Patch RSA</code></li><li><code>Use Internal Proxy</code></li><li><code>Automatically Start MongoDB</code></li><li><code>Automatically launch Grasscutter with game</code></li></ul></li><li>Set the custom Java path to <code>C:\Program Files\Java\jdk-17\bin\java.exe</code>.</li><li>Keep other options as default.</li></ul><div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-nzrair9x3"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="Config1.webp"><img data-src="https://s2.loli.net/2023/11/11/Cn7RpUYOSiuyWL8.webp" alt="Config1.webp" class="zoomable"></li><li class="splide__slide" data-caption="Config2.webp"><img data-src="https://s2.loli.net/2023/11/11/jIzsNPqfhEFkKo5.webp" alt="Config2.webp" class="zoomable"></li></ul></div></div><div id="carousel-caption-nzrair9x3" class="carousel-caption"></div></div><h1 id="XX-Launch"><a href="#XX-Launch" class="headerlink" title="XX, Launch!"></a>XX, Launch!</h1><p>The server is now configured. XX, launch!</p><ol><li>Open Cultivation.</li><li>Click on the <code>small button</code> to the right of the launch button to run Grasscutter.<ul><li>Windows Firewall-related prompts may appear; allow them.</li></ul></li><li>Click the <code>Launch</code> button to launch the game.</li><li>Enter any username and password; the system will automatically create an account.<ul><li>The password is not essential; you can enter any number when logging in next time.</li></ul></li></ol><h1 id="Commands"><a href="#Commands" class="headerlink" title="Commands"></a>Commands</h1><p>For commonly used commands, refer to <code>C:\Users\[Username]\AppData\Roaming\cultivation\grasscutter\GM Handbook</code>. Additionally, in the Grasscutter window, you can use the <code>help</code> command to view detailed usage for each command.</p><p>When running commands directly in Grasscutter, you generally need to specify UID. For example, the following command is used to remove the stamina limit for a user with UID 10001:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/prop ns on @10001</span><br></pre></td></tr></table></figure><p>Moreover, you can execute commands in the client using the built-in chat feature:</p><ol><li>Press <code>Enter</code> in the client.</li><li>Click on the <code>Add Conversation</code> in the bottom left corner.</li><li>Click the <code>plus icon</code> to the right of the friend banner to start a conversation.</li><li>Enter the command in the dialog box and send it.</li></ol><p>When directly entering commands in the chat box, keep in mind:</p><ul><li>Commands like account creation cannot be used in the chat box.</li><li>Commands generally do not require specifying UID and apply to the current user by default.</li><li>Note that commands entered in the chat box should start with <code>/</code>.</li><li>For example, <code>/give 223 x1</code> gives the current user 1 pink ball.<ul><li>223 is the ID of the pink ball.</li><li>The number after <code>x</code> represents the quantity of the item.</li></ul></li></ul><h1 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h1><p>Entering commands one by one can be tedious. I recommend using the following tools to generate commands directly. After installing the relevant plugins, you can even execute commands within the tools, eliminating the need for manual copy-pasting.</p><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/github.webp"></object><p>Grasscutter Tools</p><p>Download Grasscutter Toolbox</p><a target="_blank" rel="noopener" href="https://github.com/jie65535/GrasscutterCommandGenerator/releases"></a></div><div class="link-grid-container"><object class="link-grid-image" data="/images/link/link.webp"></object><p>GC-Tools</p><p>Online tool supporting visual command generation for artifacts</p><a target="_blank" rel="noopener" href="https://null-grasscutter-tools.vercel.app/#/artifact/index"></a></div></div><h1 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h1><p>Grasscutter supports the installation of plugins. I’ve installed the following two plugins:</p><ul><li><code>Grasscutter-Rollback</code></li><li><code>gc-opencommand-plugin</code></li></ul><p>Place the plugins in the <code>C:\Users\[Username]\AppData\Roaming\cultivation\grasscutter\plugins</code> folder.</p><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/github.webp"></object><p>Grasscutter-Rollback</p><p>Grasscutter database backup and rollback plugin</p><a target="_blank" rel="noopener" href="https://github.com/KingRainbow44/Grasscutter-Rollback"></a></div><div class="link-grid-container"><object class="link-grid-image" data="/images/link/github.webp"></object><p>gc-opencommand-plugin</p><p>Grasscutter Toolbox remote execution plugin</p><a target="_blank" rel="noopener" href="https://github.com/jie65535/gc-opencommand-plugin"></a></div></div><h2 id="gc-opencommand-plugin"><a href="#gc-opencommand-plugin" class="headerlink" title="gc-opencommand-plugin"></a>gc-opencommand-plugin</h2><p>gc-opencommand-plugin is a plugin that opens the GC command execution interface for third-party clients. It can be used with Grasscutter Tools to execute relevant commands directly without the need to input them into the in-game chat window.</p><p>Configuration steps:</p><ol><li>Start Grasscutter.</li><li>Open the folder in the <code>plugins</code> directory with the same name as the plugin JAR file and find <code>config.json</code>.</li><li>Copy the <code>token</code> from <code>config.json</code>. Normally, this token is automatically generated. If not, you can randomly create a 32-character one.</li><li>Open <code>Grasscutter Tools</code>.</li><li>Switch to the <code>Settings</code> tab.</li><li>Check the <code>UID</code> option in the program settings.</li><li>Enter the UID for the current account.</li><li>Switch to the <code>Remote</code> tab.</li><li>Click the query button next to the server address.</li><li>Confirm that there is a green checkmark after <code>Server Status - Remote Execution Plugin</code>.</li><li>Click <code>Console</code>, paste the <code>token</code> copied in step 3.</li><li>Click <code>Connect</code>.</li></ol><div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-5851tx5td"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="opencommand1.webp"><img data-src="https://s2.loli.net/2023/11/11/TPRCVJ4I1OqikyX.webp" alt="opencommand1.webp" class="zoomable"></li><li class="splide__slide" data-caption="opencommand2.webp"><img data-src="https://s2.loli.net/2023/11/11/7kPdbWUavsKeoDY.webp" alt="opencommand2.webp" class="zoomable"></li></ul></div></div><div id="carousel-caption-5851tx5td" class="carousel-caption"></div></div><h2 id="Grasscutter-Rollback"><a href="#Grasscutter-Rollback" class="headerlink" title="Grasscutter-Rollback"></a>Grasscutter-Rollback</h2><p>Grasscutter-Rollback is a database backup and rollback plugin. It can be used when there are issues with the game data, allowing you to rollback to a previous state.</p><p>Usage:</p><ul><li>Backup the current database: <code>bk</code></li><li>Rollback to the previous database: <code>rb</code></li><li>Backup the current database and rename it: <code>bk [name]</code></li><li>Rollback to a specified database: <code>rb [name]</code></li></ul><h1 id="Banner-Replacement"><a href="#Banner-Replacement" class="headerlink" title="Banner Replacement"></a>Banner Replacement</h1><p>The Grasscutter_Banners repository contains information on all banners from the server’s launch until now. Download the corresponding file, copy it to <code>C:\Users\[Username]\AppData\Roaming\cultivation\grasscutter\data\</code>, replace the original <code>Banners.json</code> file, and then execute the <code>reload</code> command in Grasscutter to change the current banner.</p><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/github.webp"></object><p>Grasscutter_Banners</p><p>Grasscutter Banners Repository</p><a target="_blank" rel="noopener" href="https://github.com/Zhaokugua/Grasscutter_Banners"></a></div></div><h1 id="Edit-Shop-Items"><a href="#Edit-Shop-Items" class="headerlink" title="Edit Shop Items"></a>Edit Shop Items</h1><p>By default, the shop contains no items. You need to add a <code>shop.json</code> file to <code>C:\Users\[Username]\AppData\Roaming\cultivation\grasscutter\data\</code>.</p><p>It is recommended to use the <code>Shop Editor</code> in the previously mentioned <code>Grasscutter Tools</code> for editing related files. Here’s how:</p><ol><li>Copy <code>C:\Users\[Username]\AppData\Roaming\cultivation\grasscutter\resources\ExcelBinOutput\ShopGoodsExcelConfigData.json</code> to another folder.</li><li>Open the <code>Shop Editor</code> in Grasscutter Tools.</li><li>Paste the copied file path into Grasscutter Tools and click <code>Load</code>.</li><li>Edit the file. Note that after completing each item, click the <code>Add or Update</code> button at the bottom; otherwise, the changes won’t take effect.</li><li>Click <code>Save</code>. You will be prompted to overwrite the file; allow it.</li><li>Rename the file to <code>shop.json</code>.</li><li>Copy the file to <code>C:\Users\[Username]。\AppData\Roaming\cultivation\grasscutter\data\</code>.</li></ol><h1 id="Character-Model-Replacement"><a href="#Character-Model-Replacement" class="headerlink" title="Character Model Replacement"></a>Character Model Replacement</h1><p>Character model mods can be downloaded from Gamebanana and injected into the game using <code>GI-Model-Importer</code>.</p><div class="link-grid"><div class="link-grid-container"><object class="link-grid-image" data="/images/link/link.webp"></object><p>Gamebanana</p><p>Mod Download Site</p><a target="_blank" rel="noopener" href="https://gamebanana.com/games/8552"></a></div><div class="link-grid-container"><object class="link-grid-image" data="/images/link/github.webp"></object><p>GI-Model-Importer</p><p>Genshin Impact custom model import tool based on 3DMigoto</p><a target="_blank" rel="noopener" href="https://github.com/SilentNightSound/GI-Model-Importer"></a></div></div><p>Here are the specific steps:</p><ol><li>Download <code>GI-Model-Importer</code> from the <a target="_blank" rel="noopener" href="https://github.com/SilentNightSound/GI-Model-Importer/releases">Release</a> page and unzip it.<ul><li>Generally, choose <code>3dmigoto-GIMI-for-playing-mods.zip</code>.</li><li>If you want to create your own mod, choose <code>3dmigoto-GIMI-for-development.zip</code>.</li></ul></li><li>Open <code>d3dx.ini</code> with VSCode.</li><li>Quickly locate by searching <code>[Loader]</code> and modify the <code>target</code> under <code>[Loader]</code> to your game installation location, for example, <code>D:\Program Files\GenshinImpact_4.0.1\GenshinImpact.exe</code>.<div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-8f4m15af4"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="Replace Path.webp"><img data-src="https://s2.loli.net/2023/11/08/E3KiqTQy9kJWZb2.webp" alt="Replace Path.webp" class="zoomable"></li></ul></div></div><div id="carousel-caption-8f4m15af4" class="carousel-caption"></div></div></li><li>Save the file.</li><li>Unzip the downloaded mod file and copy it to the <code>Mods</code> folder of GI-Model-Importer.<ul><li>Note: Only one mod can be enabled for each character.</li></ul></li><li>Start <code>3DMigoto Loader.exe</code> first.</li><li>Then start the game through <code>Cultivation</code>.</li><li>If a popup window appears in the lower-left corner of the screen during the loading process as shown in the image below, it indicates a successful launch.<div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-khcb3sx0b"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="Successful Launch Popup.webp"><img data-src="https://s2.loli.net/2023/11/08/sOvpqaElQIBf47F.webp" alt="Successful Launch Popup.webp" class="zoomable"></li></ul></div></div><div id="carousel-caption-khcb3sx0b" class="carousel-caption"></div></div></li></ol><div class="note primary"><p>For more details, please refer to the <a target="_blank" rel="noopener" href="https://github.com/SilentNightSound/GI-Model-Importer/blob/main/CN_README.md">Genshin-Impact-Model-Importer documentation</a>.</p></div><p><img data-src="https://s2.loli.net/2023/11/11/uoCZmLU3EWQ9aGf.webp" alt="可厉害了.webp"></p></div><footer class="post-footer"><div><div style="text-align:center;color:#ccc;font-size:14px">---------- This article ends here. <i class="fa fa-dice-d20"></i> Thank you for reading! ----------</div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>Post author: </strong>Sirius</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://siriusq.top/en/grasscutter.html" title="Grasscutter Windows Local Server Configuration Guide">https://siriusq.top/en/grasscutter.html</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="post-tags"><a href="/en/tags/Grasscutter/" rel="tag"><i class="fa fa-tag"></i> Grasscutter</a></div><div class="post-nav"><div class="post-nav-item"><a href="/en/clash-verge-tun-config.html" rel="prev" title="Clash Verge TUN Mode Configuration Guide"><i class="fa fa-angle-left"></i> Clash Verge TUN Mode Configuration Guide</a></div><div class="post-nav-item"><a href="/en/linux-no-bootable-device.html" rel="next" title="Solution to No Bootable Device Issue After Installing Linux on Acer Laptop">Solution to No Bootable Device Issue After Installing Linux on Acer Laptop <i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Sirius</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="Word count total">141k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="Reading time total">8:34</span></span></div><div><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("03/31/2019 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="This site has been running safely for "+dnum+" days ",document.getElementById("times").innerHTML=hnum+" hrs "+mnum+" mins "+snum+" secs"}setInterval("createtime()",250)</script></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/sidebar.js"></script><script src="/en/js/next-boot.js"></script><script src="/en/js/bookmark.js"></script><script src="/en/js/pjax.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script src="/en/js/third-party/fancybox.js"></script><script src="/en/js/third-party/pace.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script><script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://siriusq.top/en/grasscutter.html"}</script><script src="/en/js/third-party/quicklink.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous"><script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"Siriusq","repo":"gitalk-commnet","client_id":"4217cae26df745a55acd","client_secret":"b7f2cc0c82be38a4e0f294f12f761bc4799669cd","admin_user":"Siriusq","distraction_free_mode":false,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"40cdca60caeb2c03fffd33164e984f3a"}</script><script src="/en/js/third-party/comments/gitalk.js"></script><script type="text/javascript" src="/en/js/crash_cheat.js"></script><script async src="/en/js/fireworks.js"></script><script src="https://unpkg.com/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script><script>window.splideStyles={arrowColor:"#fc8d5d",arrowHoverColor:"#fc6423",paginationColor:"#fc8d5d",paginationActiveColor:"#fc6423",paginationHoverColor:"#fc6423",borderRadius:"1px",borderColor:{light:"#eee",dark:"#444"},shadowColor:{light:"rgba(0, 0, 0, 0.1)",dark:"rgba(0, 0, 0, 0.3)"}},window.splideDarkMode="auto",window.mediumZoomEnabled=!1</script><script type="text/javascript">// 页面加载事件监听
document.addEventListener('DOMContentLoaded', function () {
    splideLoadingHandler();
    initGlobalMediumZoom();
});

document.addEventListener('pjax:success', function () {
    splideLoadingHandler();
    initGlobalMediumZoom();
});

// PJAX开启时销毁所有splide实例，不然开启自动播放时图片简介和图片对不上
document.addEventListener('pjax:send', () => {
    destroySplideInstances();
});

window.splideInstances = [];
function destroySplideInstances() {
    window.splideInstances.forEach((instance) => {
        instance.destroy(); // 销毁实例
    });
    window.splideInstances = []; // 清空数组
}

// Splid 加载处理
function splideLoadingHandler() {
    // 检查页面是否含有轮播图片
    const splideEl = document.querySelector('.splide');
    if (!splideEl) {
        return; // 如果不存在轮播，则不执行初始化
    }

    // 检查是否开启Next主题的动画
    const isMotionEnabled = typeof CONFIG !== 'undefined' && CONFIG && CONFIG.motion && CONFIG.motion.enable;
    if (isMotionEnabled) {
        // Motion 开启时延迟加载轮播组件，等待动画完成。把组件加入动画有bug，一直搞不定，只能曲线救国
        setTimeout(function () {
            // 初始化轮播组件
            initSplide();
        }, 500);  // 延迟 500ms，确保动画完成后再初始化
    } else {
        // Motion 关闭时立即初始化
        initSplide();
    }

    // 处理 fancybox，默认设置会切换焦点图片造成轮播组件混乱
    if (typeof Fancybox !== "undefined") {
        adjustFancybox();
    }

    // 初始化轮播组件中的 Medium Zoom
    if (mediumZoomEnabled) {
        initCarouselMediumZoom();
    }

    // 应用主题样式
    applySplideStyle();
}

// 初始化 Splide
function initSplide() {
    const splideElements = document.querySelectorAll('.splide');
    splideElements.forEach(splideEl => {
        const options = JSON.parse(splideEl.getAttribute('data-splide'));
        // 如果轮播组件中只有一张图片，则隐藏箭头
        const slideCount = splideEl.querySelectorAll('.splide__slide').length;
        if (slideCount <= 1) {
            options.arrows = false;
        }
        // 简介设置
        const splide = new Splide(splideEl, options);
        splide.on('mounted move', function () {
            const activeSlide = splide.Components.Slides.getAt(splide.index);
            const caption = activeSlide.slide.dataset.caption;
            const captionId = splideEl.getAttribute('data-caption-id');

            const captionElement = document.getElementById(captionId);
            if (captionElement) {
                captionElement.innerText = caption || '';  // 如果没有简介，设置为空字符串
            }
        });
        splide.mount();
        window.splideInstances.push(splide); // 将实例存储到数组中   
    });
}

// 应用主题明暗样式
function applySplideStyle() {
    const applyThemeStyles = (theme, splideStyles) => {
        const borderColor = theme === 'dark' ? splideStyles.borderColor.dark : splideStyles.borderColor.light;
        const shadowColor = theme === 'dark' ? splideStyles.shadowColor.dark : splideStyles.shadowColor.light;
        document.documentElement.style.setProperty('--carousel-border-color', borderColor);
        document.documentElement.style.setProperty('--carousel-shadow-color', shadowColor);
        document.documentElement.style.setProperty('--carousel-border-radius', splideStyles.borderRadius);
        document.documentElement.style.setProperty('--carousel-arrow-color', splideStyles.arrowColor);
        document.documentElement.style.setProperty('--carousel-arrow-hover-color', splideStyles.arrowHoverColor);
        document.documentElement.style.setProperty('--carousel-pagination-color', splideStyles.paginationColor);
        document.documentElement.style.setProperty('--carousel-pagination-active-color', splideStyles.paginationActiveColor);
        document.documentElement.style.setProperty('--carousel-pagination-hover-color', splideStyles.paginationHoverColor);
    };

    let theme = 'light';
    if (window.splideDarkMode === 'auto') {
        theme = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    } else if (window.splideDarkMode === 'true') {
        theme = 'dark';
    }
    applyThemeStyles(theme, window.splideStyles);

    if (window.splideDarkMode === 'auto') {
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            applyThemeStyles(e.matches ? 'dark' : 'light', window.splideStyles);
        });
    }
}

// 初始化非轮播图片的 Medium Zoom
function initGlobalMediumZoom() {
    // 检查是否启用 medium-zoom
    if (!mediumZoomEnabled) {
        return;
    }
    const zoomOutsideCarousel = mediumZoom('img:not(.splide .zoomable)', {
        background: 'rgba(0, 0, 0, 0.8)',
        margin: 24
    });
}

// 初始化轮播组件中的 Medium Zoom
function initCarouselMediumZoom() {
    const zoomCarousel = mediumZoom('.zoomable', {
        background: 'rgba(0, 0, 0, 0.8)',
        margin: 24,
        onOpen: (zoom) => {
            const img = zoom.target; // 获取正在缩放的图片
            img.classList.add('zooming'); // 添加一个缩放时的 class
        },
        onClose: (zoom) => {
            const img = zoom.target; // 获取缩放的图片
            img.classList.remove('zooming'); // 移除缩放时的 class
        }
    });

    zoomCarousel.on('open', () => {
        // 隐藏箭头和分页按钮
        document.querySelectorAll('.splide__arrow, .splide__pagination').forEach(el => {
            el.style.display = 'none';
        });
    });

    zoomCarousel.on('close', () => {
        // 重新显示箭头和分页按钮
        document.querySelectorAll('.splide__arrow, .splide__pagination').forEach(el => {
            el.style.display = '';
        });
    });
}

// fancybox 兼容调整
function adjustFancybox() {
    Fancybox.bind("[data-fancybox]", {
        placeFocusBack: false,  // 禁止 Fancybox 关闭时滚动回页面的焦点位置
    });

    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            if (mutation.type === "childList") {
                removeFancyboxFromClones();
            }
        });
    });

    // 观察整个文档的 DOM 变化
    observer.observe(document, { childList: true, subtree: true });
}

// 移除克隆 Slide 中的 Fancybox 链接
function removeFancyboxFromClones() {
    const cloneSlides = document.querySelectorAll('.splide__slide--clone');

    cloneSlides.forEach((slide) => {
        const fancyboxLink = slide.querySelector('a.fancybox');
        if (fancyboxLink) {
            const img = fancyboxLink.querySelector('img');
            if (img) {
                // 将 img 挪出 a 标签
                fancyboxLink.replaceWith(img);
            }
        }
    });
}</script></body></html>