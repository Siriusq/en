<!DOCTYPE html><html lang="en"><head><link href="https://unpkg.com/@splidejs/splide@4.1.4/dist/css/splide.min.css" rel="stylesheet"><style type="text/css">.splide{border:2px solid var(--carousel-border-color);box-shadow:0 4px 8px var(--carousel-shadow-color);border-radius:var(--carousel-border-radius)}.splide__slide img{width:100%;height:100%;object-fit:contain}.carousel-container{visibility:inherit;margin-top:20px;margin-bottom:20px}.carousel-caption{min-height:2em;line-height:2em;text-align:center;font-size:.9em;font-style:italic;padding:6px;margin-left:auto;margin-right:auto}.splide__arrow{background:0 0;align-items:center;border:0;cursor:pointer;display:flex;height:5em;justify-content:center;position:absolute;top:50%;transform:translateY(-50%);width:5em;z-index:10}.splide__arrow:disabled{opacity:0}.splide__arrow--prev{left:0}.splide__arrow--next{right:0}.splide__arrow svg{fill:var(--carousel-arrow-color);height:2.5em;transition:fill .2s linear;width:2.5em}.splide__arrow:hover:not(:disabled) svg{fill:var(--carousel-arrow-hover-color)}.splide__arrow:focus-visible{outline:transparent;outline-offset:0}.splide.is-focus-in .splide__arrow:focus{outline:transparent;outline-offset:0}.splide__pagination__page:focus-visible{outline:transparent;outline-offset:0}.splide.is-focus-in .splide__pagination__page:focus{outline:transparent;outline-offset:0}.splide__pagination{bottom:1em;left:0;padding:0 1em;position:absolute;right:0;z-index:1}.splide__pagination__page{background:var(--carousel-pagination-color);border:0;border-radius:2.5px;display:inline-block;height:5px;margin:3px;width:20px;transition:background-color .2s linear}.splide__pagination__page.is-active{background:var(--carousel-pagination-active-color)}.splide__pagination__page:hover{background:var(--carousel-pagination-hover-color);cursor:pointer;opacity:.9}.splide__pagination__page::before{content:'';position:absolute;top:-18px;bottom:-18px;left:-4px;right:-4px}.splide__pagination__page.is-active::before{content:'';position:absolute;top:-12px;bottom:-12px;left:-1px;right:-1px}.zoomable{object-fit:contain}.zooming{max-width:90vw!important;max-height:90vh!important;object-fit:contain!important}</style><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/en/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/en/images/favicon-16x16.png"><link rel="mask-icon" href="/en/images/logo.svg" color="#222"><link rel="manifest" href="/en/images/site.webmanifest"><meta name="msvalidate.01" content="BE3DB9F22A0915AF3452024048D66934"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300italic,400,400italic,700,700italic%7CNoto+Serif:300,300italic,400,400italic,700,700italic%7CFira+Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-flash.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"siriusq.top","root":"/en/","images":"/en/images","scheme":"Gemini","darkmode":"auto","version":"8.20.0","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":320,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":false,"lazyload":true,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/en/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/en/js/config.js"></script><meta name="description" content="Lately, I’ve found myself a little envious of The Verge’s slick image carousel feature. Let’s be real—when you’ve got an organized set of images, a carousel beats a static picture group any day. Unfo"><meta property="og:type" content="article"><meta property="og:title" content="Hexo Plugin Development"><meta property="og:url" content="https://siriusq.top/en/hexo-plugin-development.html"><meta property="og:site_name" content="Sirius"><meta property="og:description" content="Lately, I’ve found myself a little envious of The Verge’s slick image carousel feature. Let’s be real—when you’ve got an organized set of images, a carousel beats a static picture group any day. Unfo"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://s2.loli.net/2024/09/18/njJmexIDHFvWt3i.webp"><meta property="og:image" content="https://s2.loli.net/2024/09/18/MZygx7LwdmqevY4.webp"><meta property="article:published_time" content="2024-09-12T04:00:08.000Z"><meta property="article:modified_time" content="2024-09-19T15:31:37.907Z"><meta property="article:author" content="Sirius"><meta property="article:tag" content="Hexo"><meta property="article:tag" content="Plugin"><meta property="article:tag" content="npm"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2024/09/18/njJmexIDHFvWt3i.webp"><link rel="canonical" href="https://siriusq.top/en/hexo-plugin-development.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://siriusq.top/en/hexo-plugin-development.html","path":"hexo-plugin-development.html","title":"Hexo Plugin Development"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Hexo Plugin Development | Sirius</title><script src="/en/live2d-widget/autoload.js"></script><noscript><link rel="stylesheet" href="/en/css/noscript.css"></noscript><link rel="alternate" href="/en/atom.xml" title="Sirius" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="Toggle navigation bar" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/en/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Sirius</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">May the Force be with you</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="Search" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/en/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/en/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/en/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">100</span></a></li><li class="menu-item menu-item-categories"><a href="/en/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">11</span></a></li><li class="menu-item menu-item-archives"><a href="/en/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">66</span></a></li><li class="menu-item menu-item-tools"><a href="/en/tools/" rel="section"><i class="fa fa-screwdriver-wrench fa-fw"></i>Tools</a></li><li class="menu-item menu-item-switch-to-chinese"><a href="https://siriusq.top/" rel="section"><i class="fa fa-language fa-fw"></i>Switch to Chinese</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="Searching..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">Table of Contents</li><li class="sidebar-nav-overview">Overview</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Create-Plugin"><span class="nav-number">1.</span> <span class="nav-text">Create Plugin</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Development"><span class="nav-number">2.</span> <span class="nav-text">Development</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#File-Structure"><span class="nav-number">2.1.</span> <span class="nav-text">File Structure</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#index-js"><span class="nav-number">2.2.</span> <span class="nav-text">index.js</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Register-Tags"><span class="nav-number">2.3.</span> <span class="nav-text">Register Tags</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Load-Files"><span class="nav-number">2.4.</span> <span class="nav-text">Load Files</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Custom-Configuration"><span class="nav-number">2.5.</span> <span class="nav-text">Custom Configuration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Injectors"><span class="nav-number">2.6.</span> <span class="nav-text">Injectors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#splide-tag-js"><span class="nav-number">2.7.</span> <span class="nav-text">splide-tag.js</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Other-Files"><span class="nav-number">2.8.</span> <span class="nav-text">Other Files</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Local-Test"><span class="nav-number">3.</span> <span class="nav-text">Local Test</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Publish"><span class="nav-number">4.</span> <span class="nav-text">Publish</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Update"><span class="nav-number">5.</span> <span class="nav-text">Update</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Submit-to-Hexo"><span class="nav-number">6.</span> <span class="nav-text">Submit to Hexo</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Sirius" src="https://s2.loli.net/2022/05/23/kxtRKT4u71HXlUY.gif"><p class="site-author-name" itemprop="name">Sirius</p><div class="site-description" itemprop="description">Thread_sleep(1); //be nice to the CPU</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/en/archives/"><span class="site-state-item-count">66</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/en/categories/"><span class="site-state-item-count">11</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/en/tags/"><span class="site-state-item-count">100</span> <span class="site-state-item-name">tags</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/Siriusq" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Siriusq" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="/en/atom.xml" title="RSS Feed → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i>RSS Feed</a> </span><span class="links-of-author-item"><a href="mailto:siriusq.top@outlook.com" title="E-Mail → mailto:siriusq.top@outlook.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://leetcode.com/Siriusq/" title="LeetCode → https:&#x2F;&#x2F;leetcode.com&#x2F;Siriusq&#x2F;" rel="noopener me" target="_blank"><i class="fa fa-code fa-fw"></i>LeetCode</a></span></div><script src="/en/js/switch_limited.js"></script></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en"><link itemprop="mainEntityOfPage" href="https://siriusq.top/en/hexo-plugin-development.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://s2.loli.net/2022/05/23/kxtRKT4u71HXlUY.gif"><meta itemprop="name" content="Sirius"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sirius"><meta itemprop="description" content="Thread_sleep(1); //be nice to the CPU"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Hexo Plugin Development | Sirius"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Hexo Plugin Development</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2024-09-12 12:00:08" itemprop="dateCreated datePublished" datetime="2024-09-12T12:00:08+08:00">2024-09-12</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">Edited on</span> <time title="Modified: 2024-09-19 23:31:37" itemprop="dateModified" datetime="2024-09-19T23:31:37+08:00">2024-09-19</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/en/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a> </span></span><span class="post-meta-break"></span> <span class="post-meta-item" title="Word count in article"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">Word count in article: </span><span>2k</span> </span><span class="post-meta-item" title="Reading time"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span>7 mins.</span></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote class="blockquote-center">Lately, I’ve found myself a little envious of The Verge’s slick image carousel feature. Let’s be real—when you’ve got an organized set of images, a carousel beats a static picture group any day. Unfortunately, Hexo doesn’t have a built-in plugin for that. So, naturally, I took matters into my own hands and whipped up a carousel plugin based on Splide, designed specifically for the NexT theme. Here’s a rundown of the journey from development to release—because why not document the process while you're at it?</blockquote><span id="more"></span><div class="note warning"><p>Version:</p><ul><li>Hexo: 7.3.0</li><li>npm: 10.8.2</li></ul></div><h1 id="Create-Plugin"><a href="#Create-Plugin" class="headerlink" title="Create Plugin"></a>Create Plugin</h1><ol><li>First things first—create a folder to house all your plugin files.<ul><li>Make sure the folder name starts with <code>hexo-</code>, like <code>hexo-splide-carousel</code>, or Hexo simply won’t recognize it. No exceptions.</li><li>No need to keep this folder inside your blog directory either.</li><li>Pro tip: use <code>git</code> to manage your code. You can set up a repo with the same name on GitHub and clone it locally.</li></ul></li><li>Next, fire up your terminal and run <code>npm init</code> to initialize the project. Just follow the prompts, and you’ll end up with a shiny new <code>package.json</code>. This file holds all the key info about your plugin—like its name, version, dependencies, etc. If you’re not sure about some options or just don’t care, stick with the defaults. You can always come back and tweak them later.<ul><li>Want the full breakdown of each part of <code>package.json</code>? Check out <a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/v10/configuring-npm/package-json">the official documentation</a>.<ul><li>Here’s an example to get you started:<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hexo-splide-carousel&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.2.1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A package for Hexo blogs using the Next theme, provides image carousel and zoom functionality using Splide and medium-zoom libraries.&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;hexo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;theme-next&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;plugin&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;splide&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;carousel&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;medium-zoom&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Siriusq&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;homepage&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/Siriusq/hexo-splide-carousel&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bugs&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/Siriusq/hexo-splide-carousel/issues&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;repository&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;git&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;git://github.com:Siriusq/hexo-splide-carousel.git&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ul></li><li>If you don’t feel like typing everything out, just go with <code>npm init -y</code>—this command auto-generates a <code>package.json</code> with all the default settings.</li></ul></li><li>Once that’s done, you should see two files in your folder: <code>index.js</code> and <code>package.json</code>. The <code>index.js</code> file is the main entry point for your plugin. This is where the magic happens.</li></ol><h1 id="Development"><a href="#Development" class="headerlink" title="Development"></a>Development</h1><p>This section might get a bit long since it’s all about the details of the plugin files I wrote. Take it with a grain of salt—I mean, this is my first time developing a Hexo plugin, so expect a few bumps along the way.</p><p>Before diving in, I’d recommend taking the time to read through the <a target="_blank" rel="noopener" href="https://hexo.io/docs/">official documentation</a>.</p><p>Now, my plugin falls under the “tag” category. Here’s the gist: during Hexo’s static file generation process, if it detects a specific tag in a markdown file (like <code>&#123;% splide %&#125;</code>), it will convert that tag and its content into the HTML structure we’ve defined.</p><p>If your plugin works differently, you can always check out these websites for similar plugins to use as inspiration:</p><ul><li><a target="_blank" rel="noopener" href="https://hexo.io/plugins/">Hexo Plugins</a></li><li><a target="_blank" rel="noopener" href="https://github.com/next-theme/awesome-next">Awesome NexT</a></li></ul><h2 id="File-Structure"><a href="#File-Structure" class="headerlink" title="File Structure"></a>File Structure</h2><p>Here’s how my plugin is structured. It’s not the gold standard of organization (for example, I wasn’t entirely sure where to put <code>splide-init.js</code> since I couldn’t find any solid guidelines). So I went with what looked sensible based on other plugins that <em>seemed</em> to be structured well enough.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hexo-splide-carousel</span><br><span class="line"> ├─index.js</span><br><span class="line"> ├─package.json</span><br><span class="line"> ├─LICENSE</span><br><span class="line"> ├─README.md</span><br><span class="line"> ├─.npmignore</span><br><span class="line"> ├─lib</span><br><span class="line"> │  ├─scripts</span><br><span class="line"> │  │  ├─splide-init.js</span><br><span class="line"> │  │  └─tags</span><br><span class="line"> │  │     └─splide-tag.js</span><br><span class="line"> │  └─assets</span><br><span class="line"> │     └─splide-custom.css</span><br><span class="line"> └─ReadmeAssets</span><br><span class="line">    ├─CNREADME.md</span><br><span class="line">    └─preview.jpg</span><br></pre></td></tr></table></figure><h2 id="index-js"><a href="#index-js" class="headerlink" title="index.js"></a>index.js</h2><p>As mentioned earlier, this is the main entry point for the plugin—the brain behind the operation. In my plugin, it handles the following:</p><ul><li>Registers custom tags</li><li>Imports necessary modules</li><li>Injects JS scripts and CSS styles into the page</li></ul><h2 id="Register-Tags"><a href="#Register-Tags" class="headerlink" title="Register Tags"></a>Register Tags</h2><p>Tag plugins help developers quickly insert content into posts. You can find more details in the <a target="_blank" rel="noopener" href="https://hexo.io/docs/tag-plugins">Tag Plugin Documentation</a>.</p><p>For my plugin, I registered two tags: <code>splide</code> and <code>sc</code>.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Register Hexo custom tag and its shorthand</span></span><br><span class="line"><span class="keyword">const</span> splideTag = <span class="built_in">require</span>(<span class="string">&#x27;./lib/scripts/tags/splide-tag&#x27;</span>)(hexo);</span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(</span><br><span class="line">  <span class="string">&quot;splide&quot;</span>,</span><br><span class="line">  splideTag,</span><br><span class="line">  &#123; <span class="attr">ends</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(</span><br><span class="line">  <span class="string">&quot;sc&quot;</span>,</span><br><span class="line">  splideTag,</span><br><span class="line">  &#123; <span class="attr">ends</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li><code>const splideTag = require(&#39;./lib/scripts/tags/splide-tag&#39;)(hexo);</code><ul><li><code>require(&#39;./lib/scripts/tags/splide-tag&#39;)</code>: This imports the tag function as a module, making it easier to update later on. The module lives at <code>./lib/scripts/tags/splide-tag.js</code>.</li><li><code>(hexo)</code>: If your tag function relies on Hexo configurations or settings, you’ll need to pass the Hexo instance into the function.</li></ul></li><li><code>hexo.extend.tag.register</code> is used to register the tag.<ul><li>The first argument is the tag name, which you’ll use in markdown files.</li><li>The second argument is the tag function. Since I imported it as a module, it keeps things clean.<ul><li>If your tag function is pretty simple, you could just pass it directly as <code>function (args, content) &#123; // ... &#125;</code>.</li></ul></li><li>The third argument contains tag options. Hexo offers two options, <code>ends</code> and <code>async</code>, both of which default to <code>false</code>.<ul><li><code>&#123; ends: true &#125;</code> means this tag will require a closing tag. In markdown files, you’d use an <code>end</code> tag to indicate where the tag finishes.</li></ul></li></ul></li></ul><h2 id="Load-Files"><a href="#Load-Files" class="headerlink" title="Load Files"></a>Load Files</h2><p>First up, I load Hexo’s built-in file I&#x2F;O module. For more info on how this works, check out <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo-fs">hexo-fs</a>.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br></pre></td></tr></table></figure><p>Then, using the <code>fs</code> module, I load additional files:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Load files from the lib directory</span></span><br><span class="line"><span class="keyword">const</span> splideInit = fs.<span class="title function_">readFileSync</span>(path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./lib/scripts/splide-init.js&quot;</span>), &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf8&quot;</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> customStyle = fs.<span class="title function_">readFileSync</span>(path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./lib/assets/splide-custom.css&quot;</span>), &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf8&quot;</span> &#125;);</span><br></pre></td></tr></table></figure><h2 id="Custom-Configuration"><a href="#Custom-Configuration" class="headerlink" title="Custom Configuration"></a>Custom Configuration</h2><p>I’ve baked in a few customizable features into the plugin, like picking which CDN provider to use or adjusting the style of the carousel. To make these adjustments easier for users, you’ll need to add some config options into the Hexo config file.</p><p>Note: In the <code>_config.yml</code> file, make sure you’re using two-space indentation.</p><p>For example, here’s how you can customize the CDN provider:</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _config.yml</span></span><br><span class="line"><span class="attr">splide:</span></span><br><span class="line">  <span class="attr">cdn:</span> <span class="string">unpkg</span>  <span class="comment"># Options: unpkg, cdnjs, jsdelivr</span></span><br></pre></td></tr></table></figure><p>Then, in <code>index.js</code>, you can read this configuration:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cdn = hexo.<span class="property">config</span>.<span class="property">splide</span>.<span class="property">cdn</span> || <span class="string">&#x27;unpkg&#x27;</span>;</span><br></pre></td></tr></table></figure><p>To prevent users from leaving options blank, it’s a good idea to set a default. The <code>|| &#39;unpkg&#39;</code> part ensures that if the CDN isn’t specified in the config, it’ll default to <code>unpkg</code>.</p><h2 id="Injectors"><a href="#Injectors" class="headerlink" title="Injectors"></a>Injectors</h2><p>Injectors are used to insert static code snippets into the generated HTML’s <code>&lt;head&gt;</code> and <code>&lt;body&gt;</code>. Hexo performs the injection before running the <code>after_render:html</code> filter. For more details, check out the <a target="_blank" rel="noopener" href="https://hexo.io/docs/injector">Injector Documentation</a>.</p><p>Earlier, we loaded the JS and CSS files, but these need to be injected into the generated HTML to take effect. Here’s an example of injecting custom styles:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Previously loaded CSS styles</span></span><br><span class="line"><span class="keyword">const</span> customStyle = fs.<span class="title function_">readFileSync</span>(path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;./lib/assets/splide-custom.css&quot;</span>), &#123; <span class="attr">encoding</span>: <span class="string">&quot;utf8&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Inject styles into the HTML</span></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">injector</span>.<span class="title function_">register</span>(</span><br><span class="line">  <span class="string">&quot;head_begin&quot;</span>,</span><br><span class="line">  <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;style type=&quot;text/css&quot;&gt;<span class="subst">$&#123;customStyle&#125;</span>&lt;/style&gt;</span></span><br><span class="line"><span class="string">      `</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;default&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li>The first parameter specifies where the code gets injected:<ul><li><code>head_begin</code>: Injects right after <code>&lt;head&gt;</code> (default)</li><li><code>head_end</code>: Injects just before <code>&lt;/head&gt;</code></li><li><code>body_begin</code>: Injects right after <code>&lt;body&gt;</code></li><li><code>body_end</code>: Injects just before <code>&lt;/body&gt;</code></li></ul></li><li>The second parameter is the code snippet to be injected.</li><li>The third parameter defines the scope of the injection:<ul><li><code>default</code>: Injects on every page (this is the default)</li><li><code>home</code>: Injects only on the homepage</li><li><code>post</code>: Injects only on post pages</li><li><code>page</code>: Injects only on standalone pages</li><li><code>archive</code>: Injects only on archive pages</li><li><code>category</code>: Injects only on category pages</li><li><code>tag</code>: Injects only on tag pages</li></ul></li></ul><h2 id="splide-tag-js"><a href="#splide-tag-js" class="headerlink" title="splide-tag.js"></a>splide-tag.js</h2><p><code>./lib/scripts/tags/splide-tag.js</code> is the tag function I imported earlier as a module. Here’s the file:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Generate HTML structure</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="function"><span class="params">hexo</span> =&gt;</span> <span class="keyword">function</span> (<span class="params">args, content</span>) &#123;</span><br><span class="line">  <span class="comment">// Fetch global default settings from Hexo config</span></span><br><span class="line">  <span class="keyword">const</span> globalSplideOptions = hexo.<span class="property">config</span>.<span class="property">splide</span>.<span class="property">options</span> || &#123;&#125;;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Parse local settings from the tag, e.g., &#123;% splide type:&#x27;loop&#x27; autoplay:true %&#125;</span></span><br><span class="line">  <span class="keyword">const</span> splideSettings = args.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, arg</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [key, value] = arg.<span class="title function_">split</span>(<span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">    acc[key] = value;</span><br><span class="line">    <span class="keyword">return</span> acc;</span><br><span class="line">  &#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Each line of images in Markdown</span></span><br><span class="line">  <span class="keyword">const</span> lines = content.<span class="title function_">trim</span>().<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Omitted content</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Generate final HTML; generate description part and id only if at least one image has a description</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;carousel-container&quot;&gt;</span></span><br><span class="line"><span class="string">      // Omitted content</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>The tag function receives two parameters: <code>args</code> and <code>content</code>. In Markdown files, my tag structure looks like this:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% splide type:&#x27;loop&#x27; autoplay:true %&#125;</span><br><span class="line">![<span class="string">alt</span>](<span class="link">url</span>)</span><br><span class="line">&#123;% endsc %&#125;</span><br></pre></td></tr></table></figure><ul><li><code>args</code> contains the parameters passed to the tag plugin, like <code>type:&#39;loop&#39; autoplay:true</code>.</li><li><code>content</code> is the content covered by the tag plugin, i.e., <code>![alt](url)</code>.</li></ul><h2 id="Other-Files"><a href="#Other-Files" class="headerlink" title="Other Files"></a>Other Files</h2><p><code>splide-init.js</code> listens for page events and determines whether to initialize the carousel component.<br><code>splide-custom.css</code> applies my custom styles, overriding some default styles of Splide.</p><h1 id="Local-Test"><a href="#Local-Test" class="headerlink" title="Local Test"></a>Local Test</h1><p>During development, we need to frequently test our plugin to ensure it works correctly.</p><ol><li>First, install our plugin in the blog project. There are several installation methods, including but not limited to:<ul><li>(Recommended) Execute the command <code>npm install &lt;plugin-path&gt;</code> in the blog root directory. This command creates a link, meaning any changes made in the plugin project’s folder will be synced in real-time to <code>blog-root/node_modules/plugin-name</code>.</li><li>If you don’t plan to upload the plugin, you can also directly move the plugin folder to <code>./node_modules</code> and manually add the plugin and its version to the <code>dependencies</code> section of <code>./package.json</code> in the blog root directory, like <code>&quot;hexo-splide-carousel&quot;: &quot;^1.0.0&quot;,</code>. If this is the last line, remember to add a comma at the end of the previous line and remove its own comma.</li></ul></li><li>If your plugin has custom configuration options, remember to add them to the Hexo configuration file <code>_config.yml</code>.</li><li>Then, proceed with the usual <code>hexo cl</code> and <code>hexo s</code> testing.</li></ol><h1 id="Publish"><a href="#Publish" class="headerlink" title="Publish"></a>Publish</h1><p>Once the plugin is complete, you can choose to upload it to npm so others can install and use it.</p><ol><li>Create a <code>README</code> file to describe the plugin’s purpose and usage. For more details, see the <a target="_blank" rel="noopener" href="https://docs.npmjs.com/about-package-readme-files">official documentation about package README files</a>.</li><li>If there are files to ignore, you can create a <code>.npmignore</code> file, which has a similar syntax to <code>.gitignore</code>. Common files like the <code>.git</code> folder and the <code>README</code> file are ignored by default, so you don’t need to add them to <code>.npmignore</code>. More information can be found in the <a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/v10/using-npm/developers#keeping-files-out-of-your-package">official documentation on keeping files out of your package</a>.</li><li>Complete the <code>package.json</code>.</li><li>Register for an account on the <a target="_blank" rel="noopener" href="https://www.npmjs.com/">npm website</a>.</li><li>Execute <code>npm login</code> in the plugin directory, then press Enter to open a browser and log in.</li><li>Execute <code>npm publish</code>, then press Enter to open a browser for identity verification.</li><li>Search for your plugin name on the npm homepage to find the recently published plugin.</li></ol><h1 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h1><p>If you discover new bugs or add new features to the plugin, you need to push the updated plugin to npm again.</p><ol><li>Execute <code>npm version &lt;version-number&gt;</code>.<ul><li>The default version number after initialization is <code>1.0.0</code>.</li><li>If the update primarily involves bug fixes, just increase the last digit, like <code>1.0.1</code>.</li><li>If you added new features that are backward-compatible, change the middle digit, like <code>1.1.0</code>.</li><li>If there are significant changes and new features that are not backward-compatible, change the first digit, like <code>2.0.0</code>.</li><li>For detailed versioning rules, see the <a target="_blank" rel="noopener" href="https://docs.npmjs.com/about-semantic-versioning">official documentation on semantic versioning</a>.</li></ul></li><li>Execute <code>npm publish</code>, then press Enter to open a browser for identity verification, and wait for the command in the terminal to complete.</li></ol><h1 id="Submit-to-Hexo"><a href="#Submit-to-Hexo" class="headerlink" title="Submit to Hexo"></a>Submit to Hexo</h1><p>After publishing the plugin, we can also submit it to the official Hexo plugin list, making it easier for more people to find and use.</p><ol><li>Fork the <a target="_blank" rel="noopener" href="https://github.com/hexojs/site">hexojs&#x2F;site</a> repository to your own account.</li><li>Clone the forked repository to your local machine.</li><li>Create a new <code>yaml</code> file in <code>./source/_data/plugins/</code>, naming it after your plugin.</li><li>In the newly created file, fill in the relevant information in English. Here’s an example:<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">description:</span> <span class="string">Server</span> <span class="string">module</span> <span class="string">for</span> <span class="string">Hexo.</span></span><br><span class="line"><span class="attr">link:</span> <span class="string">https://github.com/hexojs/hexo-server</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">official</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">server</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">console</span></span><br></pre></td></tr></table></figure></li><li>Push the changes to your repository.</li><li>Open a new pull request.<div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-vwr6tvxti"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="Open pull request"><img data-src="https://s2.loli.net/2024/09/18/njJmexIDHFvWt3i.webp" alt="Open pull request" class="zoomable"></li></ul></div></div><div id="carousel-caption-vwr6tvxti" class="carousel-caption"></div></div></li><li>In the title, describe the changes made, such as <code>Plugin: add plugin hexo-splide-carousel</code>.</li><li>Check the relevant options in the <code>Check List</code>.<div class="carousel-container"><div class="splide" data-splide='{"heightRatio":0.618,"lazyLoad":false,"type":"slide","autoplay":false,"interval":3000,"pauseOnHover":true}' data-caption-id="carousel-caption-x3yr7e6qq"><div class="splide__track"><ul class="splide__list"><li class="splide__slide" data-caption="Check the relevant options"><img data-src="https://s2.loli.net/2024/09/18/MZygx7LwdmqevY4.webp" alt="Check the relevant options" class="zoomable"></li></ul></div></div><div id="carousel-caption-x3yr7e6qq" class="carousel-caption"></div></div></li><li>Submit and wait for Hexo to complete the relevant checks.</li><li>Finally, your plugin will appear in the <a target="_blank" rel="noopener" href="https://hexo.io/plugins/">Hexo official plugin list</a>.</li></ol><blockquote><p>References</p><ol><li><a target="_blank" rel="noopener" href="http://blog.holic-x.com/md/3.component/hexo%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/common/03-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83.html">hexo-插件开发规范@一人の境</a></li><li><a target="_blank" rel="noopener" href="https://blog.shiguang666.eu.org/2024/06/22/9633525b3409/">Hexo 插件开发步骤</a></li><li><a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/api/index.html">Hexo API</a></li></ol></blockquote></div><footer class="post-footer"><div><div style="text-align:center;color:#ccc;font-size:14px">---------- This article ends here. <i class="fa fa-dice-d20"></i> Thank you for reading! ----------</div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>Post author: </strong>Sirius</li><li class="post-copyright-link"><strong>Post link: </strong><a href="https://siriusq.top/en/hexo-plugin-development.html" title="Hexo Plugin Development">https://siriusq.top/en/hexo-plugin-development.html</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li></ul></div><div class="post-tags"><a href="/en/tags/Hexo/" rel="tag"><i class="fa fa-tag"></i> Hexo</a> <a href="/en/tags/Plugin/" rel="tag"><i class="fa fa-tag"></i> Plugin</a> <a href="/en/tags/npm/" rel="tag"><i class="fa fa-tag"></i> npm</a></div><div class="post-nav"><div class="post-nav-item"><a href="/en/steam-silent-startup.html" rel="prev" title="Silently Launch Steam on System Startup"><i class="fa fa-angle-left"></i> Silently Launch Steam on System Startup</a></div><div class="post-nav-item"><a href="/en/next-8-20-update-log.html" rel="next" title="NexT 8.20 Update Log">NexT 8.20 Update Log <i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments gitalk-container"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Sirius</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="Word count total">130k</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="Reading time total">7:52</span></span></div><div><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("03/31/2019 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="This site has been running safely for "+dnum+" days ",document.getElementById("times").innerHTML=hnum+" hrs "+mnum+" mins "+snum+" secs"}setInterval("createtime()",250)</script></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="back-to-top" role="button" aria-label="Back to top"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/en/js/comments.js"></script><script src="/en/js/utils.js"></script><script src="/en/js/motion.js"></script><script src="/en/js/sidebar.js"></script><script src="/en/js/next-boot.js"></script><script src="/en/js/bookmark.js"></script><script src="/en/js/pjax.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/en/js/third-party/search/local-search.js"></script><script src="/en/js/third-party/fancybox.js"></script><script src="/en/js/third-party/pace.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script><script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://siriusq.top/en/hexo-plugin-development.html"}</script><script src="/en/js/third-party/quicklink.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous"><script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"Siriusq","repo":"gitalk-commnet","client_id":"4217cae26df745a55acd","client_secret":"b7f2cc0c82be38a4e0f294f12f761bc4799669cd","admin_user":"Siriusq","distraction_free_mode":false,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"en","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"58dc600a14b9ed8f208078bbd3e22094"}</script><script src="/en/js/third-party/comments/gitalk.js"></script><script type="text/javascript" src="/en/js/crash_cheat.js"></script><script async src="/en/js/fireworks.js"></script><script src="https://unpkg.com/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script><script>window.splideStyles={arrowColor:"#fc8d5d",arrowHoverColor:"#fc6423",paginationColor:"#fc8d5d",paginationActiveColor:"#fc6423",paginationHoverColor:"#fc6423",borderRadius:"1px",borderColor:{light:"#eee",dark:"#444"},shadowColor:{light:"rgba(0, 0, 0, 0.1)",dark:"rgba(0, 0, 0, 0.3)"}},window.splideDarkMode="auto",window.mediumZoomEnabled=!1</script><script type="text/javascript">// 页面加载事件监听
document.addEventListener('DOMContentLoaded', function () {
    splideLoadingHandler();
    initGlobalMediumZoom();
});

document.addEventListener('pjax:success', function () {
    splideLoadingHandler();
    initGlobalMediumZoom();
});

// PJAX开启时销毁所有splide实例，不然开启自动播放时图片简介和图片对不上
document.addEventListener('pjax:send', () => {
    destroySplideInstances();
});

window.splideInstances = [];
function destroySplideInstances() {
    window.splideInstances.forEach((instance) => {
        instance.destroy(); // 销毁实例
    });
    window.splideInstances = []; // 清空数组
}

// Splid 加载处理
function splideLoadingHandler() {
    // 检查页面是否含有轮播图片
    const splideEl = document.querySelector('.splide');
    if (!splideEl) {
        return; // 如果不存在轮播，则不执行初始化
    }

    // 检查是否开启Next主题的动画
    const isMotionEnabled = typeof CONFIG !== 'undefined' && CONFIG && CONFIG.motion && CONFIG.motion.enable;
    if (isMotionEnabled) {
        // Motion 开启时延迟加载轮播组件，等待动画完成。把组件加入动画有bug，一直搞不定，只能曲线救国
        setTimeout(function () {
            // 初始化轮播组件
            initSplide();
        }, 500);  // 延迟 500ms，确保动画完成后再初始化
    } else {
        // Motion 关闭时立即初始化
        initSplide();
    }

    // 处理 fancybox，默认设置会切换焦点图片造成轮播组件混乱
    if (typeof Fancybox !== "undefined") {
        adjustFancybox();
    }

    // 初始化轮播组件中的 Medium Zoom
    if (mediumZoomEnabled) {
        initCarouselMediumZoom();
    }

    // 应用主题样式
    applySplideStyle();
}

// 初始化 Splide
function initSplide() {
    const splideElements = document.querySelectorAll('.splide');
    splideElements.forEach(splideEl => {
        const options = JSON.parse(splideEl.getAttribute('data-splide'));
        // 如果轮播组件中只有一张图片，则隐藏箭头
        const slideCount = splideEl.querySelectorAll('.splide__slide').length;
        if (slideCount <= 1) {
            options.arrows = false;
        }
        // 简介设置
        const splide = new Splide(splideEl, options);
        splide.on('mounted move', function () {
            const activeSlide = splide.Components.Slides.getAt(splide.index);
            const caption = activeSlide.slide.dataset.caption;
            const captionId = splideEl.getAttribute('data-caption-id');

            const captionElement = document.getElementById(captionId);
            if (captionElement) {
                captionElement.innerText = caption || '';  // 如果没有简介，设置为空字符串
            }
        });
        splide.mount();
        window.splideInstances.push(splide); // 将实例存储到数组中   
    });
}

// 应用主题明暗样式
function applySplideStyle() {
    const applyThemeStyles = (theme, splideStyles) => {
        const borderColor = theme === 'dark' ? splideStyles.borderColor.dark : splideStyles.borderColor.light;
        const shadowColor = theme === 'dark' ? splideStyles.shadowColor.dark : splideStyles.shadowColor.light;
        document.documentElement.style.setProperty('--carousel-border-color', borderColor);
        document.documentElement.style.setProperty('--carousel-shadow-color', shadowColor);
        document.documentElement.style.setProperty('--carousel-border-radius', splideStyles.borderRadius);
        document.documentElement.style.setProperty('--carousel-arrow-color', splideStyles.arrowColor);
        document.documentElement.style.setProperty('--carousel-arrow-hover-color', splideStyles.arrowHoverColor);
        document.documentElement.style.setProperty('--carousel-pagination-color', splideStyles.paginationColor);
        document.documentElement.style.setProperty('--carousel-pagination-active-color', splideStyles.paginationActiveColor);
        document.documentElement.style.setProperty('--carousel-pagination-hover-color', splideStyles.paginationHoverColor);
    };

    let theme = 'light';
    if (window.splideDarkMode === 'auto') {
        theme = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    } else if (window.splideDarkMode === 'true') {
        theme = 'dark';
    }
    applyThemeStyles(theme, window.splideStyles);

    if (window.splideDarkMode === 'auto') {
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            applyThemeStyles(e.matches ? 'dark' : 'light', window.splideStyles);
        });
    }
}

// 初始化非轮播图片的 Medium Zoom
function initGlobalMediumZoom() {
    // 检查是否启用 medium-zoom
    if (!mediumZoomEnabled) {
        return;
    }
    const zoomOutsideCarousel = mediumZoom('img:not(.splide .zoomable)', {
        background: 'rgba(0, 0, 0, 0.8)',
        margin: 24
    });
}

// 初始化轮播组件中的 Medium Zoom
function initCarouselMediumZoom() {
    const zoomCarousel = mediumZoom('.zoomable', {
        background: 'rgba(0, 0, 0, 0.8)',
        margin: 24,
        onOpen: (zoom) => {
            const img = zoom.target; // 获取正在缩放的图片
            img.classList.add('zooming'); // 添加一个缩放时的 class
        },
        onClose: (zoom) => {
            const img = zoom.target; // 获取缩放的图片
            img.classList.remove('zooming'); // 移除缩放时的 class
        }
    });

    zoomCarousel.on('open', () => {
        // 隐藏箭头和分页按钮
        document.querySelectorAll('.splide__arrow, .splide__pagination').forEach(el => {
            el.style.display = 'none';
        });
    });

    zoomCarousel.on('close', () => {
        // 重新显示箭头和分页按钮
        document.querySelectorAll('.splide__arrow, .splide__pagination').forEach(el => {
            el.style.display = '';
        });
    });
}

// fancybox 兼容调整
function adjustFancybox() {
    Fancybox.bind("[data-fancybox]", {
        placeFocusBack: false,  // 禁止 Fancybox 关闭时滚动回页面的焦点位置
    });

    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            if (mutation.type === "childList") {
                removeFancyboxFromClones();
            }
        });
    });

    // 观察整个文档的 DOM 变化
    observer.observe(document, { childList: true, subtree: true });
}

// 移除克隆 Slide 中的 Fancybox 链接
function removeFancyboxFromClones() {
    const cloneSlides = document.querySelectorAll('.splide__slide--clone');

    cloneSlides.forEach((slide) => {
        const fancyboxLink = slide.querySelector('a.fancybox');
        if (fancyboxLink) {
            const img = fancyboxLink.querySelector('img');
            if (img) {
                // 将 img 挪出 a 标签
                fancyboxLink.replaceWith(img);
            }
        }
    });
}</script></body></html>